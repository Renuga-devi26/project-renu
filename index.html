<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RuralCare AI - Advanced Offline Health Screening</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Segoe UI,Arial;background:#f5f5f6;padding:20px;color:#263238}
.container{max-width:1300px;margin:auto}
.section{background:#fff;padding:25px;border-radius:14px;margin-bottom:25px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
h2{color:#1b5e20;margin-bottom:15px}
.form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px}
input,select{padding:10px;border:1px solid #ccc;border-radius:6px;width:100%}
button{padding:12px 20px;border:none;border-radius:6px;cursor:pointer;font-weight:600}
.btn-primary{background:#1b5e20;color:#fff}
.btn-warning{background:#ef6c00;color:#fff}
.btn-secondary{background:#eee}
#results{display:none;margin-top:20px}
.status-healthy{color:#2e7d32;font-weight:bold}
.status-followup{color:#ef6c00;font-weight:bold}
.progress{height:20px;background:#ddd;border-radius:10px;margin-top:8px;overflow:hidden}
.progress-bar{height:100%;background:#1b5e20;width:0%}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{padding:10px;border-bottom:1px solid #ddd;text-align:left}
th{background:#1b5e20;color:white}
.preview{max-width:400px;margin-top:15px;border-radius:10px}
</style>
</head>

<body>
<div class="container">

<div class="section">
<h2>ðŸ“‹ Patient Information</h2>
<div class="form-grid">
<input type="text" id="patientId" placeholder="Patient ID" required>
<input type="text" id="patientName" placeholder="Full Name" required>
<input type="number" id="patientAge" placeholder="Age" required>
<select id="patientGender">
<option value="male">Male</option>
<option value="female">Female</option>
<option value="other">Other</option>
</select>
<input type="number" id="height" placeholder="Height (cm)">
<input type="number" id="weight" placeholder="Weight (kg)">
<input type="number" step="0.1" id="temperature" placeholder="Temperature Â°C">
<input type="text" id="bp" placeholder="Blood Pressure (120/80)">
</div>
</div>

<div class="section">
<h2>ðŸ“¸ Upload Photo</h2>
<input type="file" id="imageUpload" accept="image/*">
<img id="preview" class="preview">
</div>

<button class="btn-primary" onclick="analyzeHealth()">ðŸ”¬ Analyze Health</button>

<div id="results" class="section">
<h2>ðŸ§¾ Screening Report</h2>
<p id="statusText"></p>
<p id="description"></p>
<div>
AI Confidence
<div class="progress"><div id="confidenceBar" class="progress-bar"></div></div>
<p id="confidenceText"></p>
</div>
<ul id="recommendations"></ul>
<p id="followUp"></p>
</div>

<div class="section">
<h2>ðŸ“Š Recent Screenings</h2>
<table>
<thead>
<tr><th>Time</th><th>ID</th><th>Name</th><th>Status</th></tr>
</thead>
<tbody id="tableBody"></tbody>
</table>
</div>

</div>

<script>
let capturedImage=null;
let screenings=JSON.parse(localStorage.getItem("screenings")||"[]");

document.getElementById("imageUpload").addEventListener("change",function(e){
const file=e.target.files[0];
if(!file)return;
const reader=new FileReader();
reader.onload=function(event){
capturedImage=event.target.result;
document.getElementById("preview").src=capturedImage;
}
reader.readAsDataURL(file);
});

function analyzeHealth(){

try{

const id=document.getElementById("patientId").value.trim();
const name=document.getElementById("patientName").value.trim();
const age=parseInt(document.getElementById("patientAge").value);
const gender=document.getElementById("patientGender").value;
const height=parseFloat(document.getElementById("height").value)||0;
const weight=parseFloat(document.getElementById("weight").value)||0;
const temp=parseFloat(document.getElementById("temperature").value)||36.5;
const bp=document.getElementById("bp").value||"";

if(!id||!name||!age||!capturedImage){
alert("Please fill required fields and upload photo");
return;
}

let bmi=0;
if(height>0&&weight>0){
bmi=(weight/Math.pow(height/100,2));
}

let followUp=false;
let confidence=85;

// Age Logic
if(age>70||age<3){followUp=true;confidence+=5}

// Temperature Logic
if(temp>38.5||temp<35){followUp=true;confidence+=5}

// BP Logic
if(bp.includes("160")||bp.includes("170")||bp.includes("180")){followUp=true;confidence+=5}

// BMI Logic
if(bmi>32||bmi<16){followUp=true;confidence+=5}

// Image Validation
if(capturedImage.length<1000){followUp=true;confidence=70}

confidence=Math.min(confidence,98);

let result;

if(!followUp){
result={
status:"healthy",
statusText:"âœ… Healthy",
description:"No major abnormal health indicators detected based on multi-factor AI analysis.",
confidence:confidence,
recommendations:[
"Maintain balanced nutrition",
"Stay hydrated",
"Regular physical activity",
"Periodic screening every 3 months",
"Monitor temperature occasionally"
],
followUp:"No immediate follow-up required."
};
}else{
result={
status:"followup",
statusText:"âš ï¸ Needs Follow-up",
description:"Multiple health indicators suggest clinical evaluation is recommended.",
confidence:confidence,
recommendations:[
"Visit Primary Health Center within 3-7 days",
"Carry this screening report",
"Monitor BP and temperature daily",
"Avoid heavy work",
"Ensure proper hydration and rest"
],
followUp:"Professional medical evaluation recommended."
};
}

displayResults(result);
saveScreening(id,name,age,result);

}catch(err){
alert("Unexpected error occurred. Please retry.");
}
}

function displayResults(result){
document.getElementById("results").style.display="block";
document.getElementById("statusText").innerHTML=result.status==="healthy"?
"<span class='status-healthy'>"+result.statusText+"</span>":
"<span class='status-followup'>"+result.statusText+"</span>";
document.getElementById("description").innerText=result.description;
document.getElementById("confidenceBar").style.width=result.confidence+"%";
document.getElementById("confidenceText").innerText=result.confidence+"%";
document.getElementById("recommendations").innerHTML=result.recommendations.map(r=>"<li>"+r+"</li>").join("");
document.getElementById("followUp").innerText=result.followUp;
}

function saveScreening(id,name,age,result){
const record={
time:new Date().toLocaleString(),
patientId:id,
name:name,
age:age,
status:result.statusText
};
screenings.unshift(record);
if(screenings.length>20)screenings.pop();
localStorage.setItem("screenings",JSON.stringify(screenings));
renderTable();
}

function renderTable(){
const tbody=document.getElementById("tableBody");
if(screenings.length===0){
tbody.innerHTML="<tr><td colspan='4'>No records</td></tr>";
return;
}
tbody.innerHTML=screenings.map(s=>`
<tr>
<td>${s.time}</td>
<td>${s.patientId}</td>
<td>${s.name}</td>
<td>${s.status}</td>
</tr>
`).join("");
}

renderTable();
</script>

</body>
</html>
