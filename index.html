<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>RuralCare Pro - Complete Healthcare Platform</title>
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        :root {
            --primary: #0d9488;
            --primary-dark: #0f766e;
            --primary-light: #14b8a6;
            --secondary: #8b5cf6;
            --accent: #f59e0b;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f97316;
            --info: #3b82f6;
            --background: #f0fdfa;
            --surface: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-light: #94a3b8;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }

        body {
            background: linear-gradient(135deg, #f0fdfa 0%, #e6fffa 100%);
            color: var(--text-primary);
            min-height: 100vh;
            font-size: 16px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ========== LOGIN PAGE STYLES ========== */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 48px;
            padding: 48px;
            max-width: 500px;
            width: 100%;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(13, 148, 136, 0.2);
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-header h1 {
            color: var(--primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .login-header p {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .login-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 10px;
        }

        .login-tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 30px;
            transition: all 0.3s;
        }

        .login-tab.active {
            background: var(--primary);
            color: white;
        }

        .login-form {
            display: none;
        }

        .login-form.active {
            display: block;
        }

        .input-group {
            position: relative;
            margin-bottom: 25px;
        }

        .input-group i {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            font-size: 1.2rem;
            z-index: 1;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 16px 16px 16px 50px;
            border: 2px solid var(--border);
            border-radius: 60px;
            font-size: 1rem;
            background: white;
            transition: all 0.3s;
        }

        .input-group textarea {
            border-radius: 30px;
            resize: vertical;
            min-height: 80px;
        }

        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(13, 148, 136, 0.1);
        }

        .input-group label {
            position: absolute;
            left: 50px;
            top: -10px;
            background: white;
            padding: 0 8px;
            font-size: 0.8rem;
            color: var(--primary);
            font-weight: 600;
            border-radius: 20px;
            opacity: 0;
            transition: 0.2s;
        }

        .input-group input:focus + label,
        .input-group input:not(:placeholder-shown) + label,
        .input-group textarea:focus + label,
        .input-group textarea:not(:placeholder-shown) + label {
            opacity: 1;
            top: -10px;
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 60px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 20px -5px var(--primary);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px -5px var(--primary);
        }

        .forgot-link {
            text-align: right;
            margin: 10px 0;
        }

        .forgot-link a {
            color: var(--primary);
            text-decoration: none;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .forgot-link a:hover {
            text-decoration: underline;
        }

        /* ========== MAIN APP STYLES ========== */
        .main-app {
            display: none;
        }

        .main-app.visible {
            display: block;
        }

        /* Language Switcher */
        .language-bar {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .lang-btn {
            padding: 10px 20px;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .lang-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Premium Header */
        .premium-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 40px;
            padding: 40px;
            margin-bottom: 30px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .premium-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 80%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            transform: rotate(30deg);
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header-content h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 24px;
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow-lg);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Patient Info Card */
        .patient-card {
            background: white;
            border-radius: 32px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
        }

        .patient-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        /* Patient Records Section */
        .records-section {
            background: white;
            border-radius: 32px;
            padding: 24px;
            margin: 30px 0;
            box-shadow: var(--shadow-lg);
        }

        .records-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .records-search {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .records-search input {
            padding: 12px 20px;
            border: 2px solid var(--border);
            border-radius: 30px;
            min-width: 250px;
        }

        .records-table-container {
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }

        .records-table {
            width: 100%;
            border-collapse: collapse;
        }

        .records-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            position: sticky;
            top: 0;
        }

        .records-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .records-table tr:hover {
            background: var(--background);
        }

        .view-btn {
            padding: 6px 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
        }

        /* Voice Section */
        .voice-section {
            background: linear-gradient(135deg, #e0f2fe, #bae6fd);
            border-radius: 40px;
            padding: 30px;
            margin: 30px 0;
        }

        .voice-controls {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .record-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--danger);
            color: white;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .record-btn.recording {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .voice-status {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 10px;
        }

        /* Symptoms Grid - Expanded */
        .symptoms-section {
            background: white;
            border-radius: 32px;
            padding: 24px;
            margin: 30px 0;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .category-tab {
            padding: 10px 20px;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-tab.active {
            background: var(--primary);
            color: white;
        }

        .symptoms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
            max-height: 500px;
            overflow-y: auto;
            padding: 15px;
            background: var(--background);
            border-radius: 20px;
        }

        .symptom-item {
            padding: 12px;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .symptom-item:hover {
            border-color: var(--primary);
        }

        .symptom-item.selected {
            background: var(--primary);
            color: white;
        }

        .symptom-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
            min-height: 50px;
        }

        .symptom-tag {
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .symptom-tag button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Analyze Button */
        .analyze-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, var(--accent), var(--warning));
            color: white;
            border: none;
            border-radius: 60px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            margin: 30px 0;
            box-shadow: 0 10px 30px -5px var(--accent);
        }

        /* Results */
        .results-card {
            background: white;
            border-radius: 32px;
            padding: 32px;
            margin: 30px 0;
            box-shadow: var(--shadow-xl);
            display: none;
        }

        .severity-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: 600;
        }

        .severity-low { background: #dcfce7; color: #166534; }
        .severity-medium { background: #fed7aa; color: #9a3412; }
        .severity-high { background: #fee2e2; color: #991b1b; }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 15px 25px;
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(200px);
            background: white;
            padding: 16px 32px;
            border-radius: 60px;
            box-shadow: var(--shadow-xl);
            border-left: 4px solid var(--success);
            transition: transform 0.3s;
            z-index: 2000;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        /* Logout Button */
        .logout-btn {
            position: absolute;
            top: 30px;
            right: 40px;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            padding: 10px 25px;
            border-radius: 40px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            z-index: 2;
        }

        .logout-btn:hover {
            background: white;
            color: var(--primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .login-card {
                padding: 30px;
            }
            
            .header-content h1 {
                font-size: 1.8rem;
            }
            
            .records-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .records-search {
                flex-direction: column;
            }
            
            .records-search input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div class="login-container" id="loginPage">
        <div class="login-card">
            <div class="login-header">
                <h1>
                    <i class="fas fa-leaf"></i>
                    RuralCare Pro
                </h1>
                <p>Your Complete Healthcare Assistant</p>
            </div>

            <div class="login-tabs">
                <button class="login-tab active" onclick="switchAuthTab('login')">Login</button>
                <button class="login-tab" onclick="switchAuthTab('signup')">Sign Up</button>
                <button class="login-tab" onclick="switchAuthTab('forgot')">Forgot</button>
            </div>

            <!-- Login Form -->
            <div class="login-form active" id="loginForm">
                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="loginEmail" placeholder=" " value="test@example.com">
                    <label>Email</label>
                </div>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="loginPassword" placeholder=" " value="123456">
                    <label>Password</label>
                </div>
                <div class="forgot-link">
                    <a onclick="switchAuthTab('forgot')">Forgot Password?</a>
                </div>
                <button class="login-btn" onclick="handleLogin()">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
            </div>

            <!-- Signup Form -->
            <div class="login-form" id="signupForm">
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="signupName" placeholder=" ">
                    <label>Full Name</label>
                </div>
                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="signupEmail" placeholder=" ">
                    <label>Email</label>
                </div>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="signupPassword" placeholder=" ">
                    <label>Password</label>
                </div>
                <div class="input-group">
                    <i class="fas fa-phone"></i>
                    <input type="text" id="signupPhone" placeholder=" ">
                    <label>Phone (optional)</label>
                </div>
                <button class="login-btn" onclick="handleSignup()">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
            </div>

            <!-- Forgot Password Form -->
            <div class="login-form" id="forgotForm">
                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="forgotEmail" placeholder=" ">
                    <label>Email</label>
                </div>
                <button class="login-btn" onclick="handleForgotPassword()">
                    <i class="fas fa-paper-plane"></i> Send Reset Link
                </button>
                <p style="text-align: center; margin-top: 20px; font-size: 0.9rem; color: var(--text-secondary);">
                    We'll send a password reset link to your email
                </p>
            </div>
        </div>
    </div>

    <!-- MAIN APPLICATION (Hidden until login) -->
    <div class="main-app" id="mainApp">
        <div class="container">
            <!-- Logout Button -->
            <button class="logout-btn" onclick="handleLogout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>

            <!-- Language Switcher -->
            <div class="language-bar">
                <button class="lang-btn active" onclick="switchLanguage('en')">üá¨üáß English</button>
                <button class="lang-btn" onclick="switchLanguage('hi')">üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
                <button class="lang-btn" onclick="switchLanguage('ta')">üáÆüá≥ ‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
                <button class="lang-btn" onclick="switchLanguage('te')">üáÆüá≥ ‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</button>
                <button class="lang-btn" onclick="switchLanguage('kn')">üáÆüá≥ ‡≤ï‡≤®‡≥ç‡≤®‡≤°</button>
                <button class="lang-btn" onclick="switchLanguage('ml')">üáÆüá≥ ‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
            </div>

            <!-- Premium Header -->
            <header class="premium-header">
                <div class="header-content">
                    <h1>
                        <i class="fas fa-leaf"></i>
                        <span data-i18n="appName">RuralCare Pro</span>
                    </h1>
                    <p data-i18n="appSubtitle">AI-Powered Healthcare Assistant</p>
                </div>
            </header>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalUsers">0</div>
                    <div class="stat-label" data-i18n="totalUsers">Total Users</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalDiagnoses">0</div>
                    <div class="stat-label" data-i18n="totalDiagnoses">Diagnoses</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="highRiskCount">0</div>
                    <div class="stat-label" data-i18n="highRisk">High Risk</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="todayCount">0</div>
                    <div class="stat-label" data-i18n="today">Today</div>
                </div>
            </div>

            <!-- Patient Information -->
            <div class="patient-card">
                <h2 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-user-circle"></i> 
                    <span data-i18n="patientInfo">Patient Information</span>
                </h2>
                <div class="patient-grid">
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="patientName" placeholder=" " value="John Doe">
                        <label data-i18n="fullName">Full Name</label>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-calendar-alt"></i>
                        <input type="number" id="patientAge" placeholder=" " value="35">
                        <label data-i18n="age">Age</label>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-venus-mars"></i>
                        <select id="patientGender">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-map-marker-alt"></i>
                        <select id="patientDistrict">
                            <option value="">Select District</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Patient Records Section -->
            <div class="records-section">
                <div class="records-header">
                    <h2 style="color: var(--primary);">
                        <i class="fas fa-history"></i> Past Patient Records
                    </h2>
                    <div class="records-search">
                        <input type="text" id="recordSearch" placeholder="üîç Search by name, diagnosis..." onkeyup="searchRecords()">
                        <button class="action-btn" onclick="clearAllRecords()">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                    </div>
                </div>
                
                <div class="records-table-container">
                    <table class="records-table" id="recordsTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Patient</th>
                                <th>Age</th>
                                <th>Gender</th>
                                <th>District</th>
                                <th>Diagnosis</th>
                                <th>Severity</th>
                                <th>Symptoms</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="recordsBody">
                            <tr><td colspan="9" style="text-align: center;">No records yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Voice Recording Section -->
            <div class="voice-section">
                <h2 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-microphone-alt"></i>
                    <span data-i18n="voiceTitle">Voice Symptom Recorder</span>
                </h2>
                
                <div class="voice-controls">
                    <button class="record-btn" id="recordBtn" onclick="toggleRecording()">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <div style="flex: 1;">
                        <div style="background: white; border-radius: 40px; padding: 15px;">
                            <span class="timer" id="timer">00:00</span>
                        </div>
                    </div>
                </div>
                
                <div class="voice-status" id="voiceStatus">
                    <i class="fas fa-info-circle"></i> Click the microphone and speak in your language
                </div>

                <div style="margin-top: 20px;">
                    <div class="input-group">
                        <i class="fas fa-pen"></i>
                        <textarea id="symptomsText" placeholder=" " rows="2"></textarea>
                        <label data-i18n="typeSymptoms">Or type your symptoms (comma separated)</label>
                    </div>
                </div>
            </div>

            <!-- Symptom Checker - Expanded -->
            <div class="symptoms-section">
                <h2 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-stethoscope"></i>
                    <span data-i18n="symptomChecker">Symptom Checker (100+ Symptoms)</span>
                </h2>

                <div class="category-tabs" id="symptomCategories">
                    <button class="category-tab active" onclick="filterSymptoms('all')">All</button>
                    <button class="category-tab" onclick="filterSymptoms('respiratory')">Respiratory</button>
                    <button class="category-tab" onclick="filterSymptoms('digestive')">Digestive</button>
                    <button class="category-tab" onclick="filterSymptoms('neurological')">Neurological</button>
                    <button class="category-tab" onclick="filterSymptoms('cardiovascular')">Cardio</button>
                    <button class="category-tab" onclick="filterSymptoms('muscular')">Muscular</button>
                    <button class="category-tab" onclick="filterSymptoms('skin')">Skin</button>
                    <button class="category-tab" onclick="filterSymptoms('general')">General</button>
                    <button class="category-tab" onclick="filterSymptoms('infectious')">Infectious</button>
                    <button class="category-tab" onclick="filterSymptoms('metabolic')">Metabolic</button>
                    <button class="category-tab" onclick="filterSymptoms('mental')">Mental</button>
                </div>

                <div class="symptoms-grid" id="symptomsGrid"></div>

                <div style="margin-top: 20px;">
                    <h4>Selected Symptoms:</h4>
                    <div class="symptom-tags" id="symptomTags"></div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="action-btn" onclick="clearSelection()">
                    <i class="fas fa-eraser"></i> Clear Selection
                </button>
                <button class="action-btn" onclick="exportRecords()">
                    <i class="fas fa-download"></i> Export Records
                </button>
                <button class="action-btn" onclick="loadSamplePatient()">
                    <i class="fas fa-user-md"></i> Load Sample
                </button>
            </div>

            <!-- Analyze Button -->
            <button class="analyze-btn" onclick="analyzeHealth()" id="analyzeBtn">
                <i class="fas fa-microchip"></i>
                <span data-i18n="analyze">Run AI Diagnosis</span>
            </button>

            <!-- Results -->
            <div class="results-card" id="results"></div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // ==================== SERVER SIMULATION (LocalStorage) ====================
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let diagnoses = JSON.parse(localStorage.getItem('diagnoses')) || [];
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let passwordResetRequests = JSON.parse(localStorage.getItem('resetRequests')) || [];

        // ==================== MULTI-LANGUAGE SUPPORT ====================
        let currentLanguage = 'en';
        
        const translations = {
            en: {
                appName: 'RuralCare Pro',
                appSubtitle: 'AI-Powered Healthcare Assistant',
                totalUsers: 'Total Users',
                totalDiagnoses: 'Diagnoses',
                highRisk: 'High Risk',
                today: 'Today',
                patientInfo: 'Patient Information',
                fullName: 'Full Name',
                age: 'Age',
                voiceTitle: 'Voice Symptom Recorder',
                typeSymptoms: 'Or type your symptoms (comma separated)',
                symptomChecker: 'Symptom Checker (100+ Symptoms)',
                analyze: 'Run AI Diagnosis',
                consultDoctor: 'Consult Doctor Immediately',
                homeRemedies: 'Home Remedies',
                warningSigns: 'Warning Signs',
                medicines: 'Recommended Medicines'
            },
            hi: {
                appName: '‡§∞‡•Ç‡§∞‡§≤‡§ï‡•á‡§Ø‡§∞ ‡§™‡•ç‡§∞‡•ã',
                appSubtitle: '‡§è‡§Ü‡§à-‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡§π‡§æ‡§Ø‡§ï',
                totalUsers: '‡§ï‡•Å‡§≤ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ',
                totalDiagnoses: '‡§®‡§ø‡§¶‡§æ‡§®',
                highRisk: '‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ',
                today: '‡§Ü‡§ú',
                patientInfo: '‡§∞‡•ã‡§ó‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä',
                fullName: '‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ',
                age: '‡§Ü‡§Ø‡•Å',
                voiceTitle: '‡§Ü‡§µ‡§æ‡§ú ‡§≤‡§ï‡•ç‡§∑‡§£ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡§∞',
                typeSymptoms: '‡§Ø‡§æ ‡§Ö‡§™‡§®‡•á ‡§≤‡§ï‡•ç‡§∑‡§£ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç (‡§Ö‡§≤‡•ç‡§™‡§µ‡§ø‡§∞‡§æ‡§Æ ‡§∏‡•á ‡§Ö‡§≤‡§ó)',
                symptomChecker: '‡§≤‡§ï‡•ç‡§∑‡§£ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§ï (100+ ‡§≤‡§ï‡•ç‡§∑‡§£)',
                analyze: '‡§è‡§Ü‡§à ‡§®‡§ø‡§¶‡§æ‡§® ‡§ö‡§≤‡§æ‡§è‡§Ç',
                consultDoctor: '‡§§‡•Å‡§∞‡§Ç‡§§ ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§∏‡•á ‡§Æ‡§ø‡§≤‡•á‡§Ç',
                homeRemedies: '‡§ò‡§∞‡•á‡§≤‡•Ç ‡§â‡§™‡§ö‡§æ‡§∞',
                warningSigns: '‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä ‡§∏‡§Ç‡§ï‡•á‡§§',
                medicines: '‡§Ö‡§®‡•Å‡§∂‡§Ç‡§∏‡§ø‡§§ ‡§¶‡§µ‡§æ‡§è‡§Ç'
            },
            ta: {
                appName: '‡Æ∞‡ØÇ‡Æ∞‡Æ≤‡Øç‡Æï‡Øá‡Æ∞‡Øç ‡Æ™‡ØÅ‡Æ∞‡Øã',
                appSubtitle: '‡Æè‡Æê-‡Æá‡ÆØ‡Æô‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æâ‡Æ§‡Æµ‡Æø‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç',
                totalUsers: '‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ ‡Æ™‡ÆØ‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç',
                totalDiagnoses: '‡Æ®‡Øã‡ÆØ‡Æ±‡Æø‡Æ§‡Æ≤‡Øç‡Æï‡Æ≥‡Øç',
                highRisk: '‡ÆÖ‡Æ§‡Æø‡Æï ‡ÆÜ‡Æ™‡Æ§‡Øç‡Æ§‡ØÅ',
                today: '‡Æá‡Æ©‡Øç‡Æ±‡ØÅ',
                patientInfo: '‡Æ®‡Øã‡ÆØ‡Ææ‡Æ≥‡Æø ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç',
                fullName: '‡ÆÆ‡ØÅ‡Æ¥‡ØÅ ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç',
                age: '‡Æµ‡ÆØ‡Æ§‡ØÅ',
                voiceTitle: '‡Æï‡ØÅ‡Æ∞‡Æ≤‡Øç ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø ‡Æ™‡Æ§‡Æø‡Æµ‡Æø',
                typeSymptoms: '‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øà ‡Æ§‡Æü‡Øç‡Æü‡Æö‡Øç‡Æö‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡Æï (‡Æï‡ÆÆ‡Ææ‡Æµ‡Ææ‡Æ≤‡Øç ‡Æ™‡Æø‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç)',
                symptomChecker: '‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø ‡Æö‡Æ∞‡Æø‡Æ™‡Ææ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Øç (100+ ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øç)',
                analyze: '‡Æè‡Æê ‡Æ®‡Øã‡ÆØ‡Æ±‡Æø‡Æ§‡Æ≤‡Øà ‡Æá‡ÆØ‡Æï‡Øç‡Æï‡ØÅ',
                consultDoctor: '‡Æâ‡Æü‡Æ©‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ‡Æ∞‡Øà ‡ÆÖ‡Æ£‡ØÅ‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç',
                homeRemedies: '‡Æµ‡ØÄ‡Æü‡Øç‡Æü‡ØÅ ‡Æµ‡Øà‡Æ§‡Øç‡Æ§‡Æø‡ÆØ‡ÆÆ‡Øç',
                warningSigns: '‡Æé‡Æö‡Øç‡Æö‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Øà ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øç',
                medicines: '‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡ÆÆ‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ‡Æï‡Æ≥‡Øç'
            }
        };

        // ==================== TAMIL NADU DISTRICTS ====================
        const districts = [
            'Chennai', 'Coimbatore', 'Madurai', 'Tiruchirappalli', 'Salem',
            'Tirunelveli', 'Vellore', 'Erode', 'Kanyakumari', 'Dharmapuri',
            'Viluppuram', 'Kanchipuram', 'Nagapattinam', 'Thanjavur', 'Thoothukkudi',
            'Ramanathapuram', 'Sivaganga', 'Pudukkottai', 'Dindigul', 'Theni'
        ];

        // ==================== EXPANDED SYMPTOMS DATABASE (100+ Symptoms) ====================
        const symptomsDB = [
            // Respiratory (15)
            { id: 1, name: 'Cough', category: 'respiratory' },
            { id: 2, name: 'Shortness of breath', category: 'respiratory' },
            { id: 3, name: 'Wheezing', category: 'respiratory' },
            { id: 4, name: 'Chest pain', category: 'respiratory' },
            { id: 5, name: 'Sore throat', category: 'respiratory' },
            { id: 6, name: 'Runny nose', category: 'respiratory' },
            { id: 7, name: 'Sneezing', category: 'respiratory' },
            { id: 8, name: 'Nasal congestion', category: 'respiratory' },
            { id: 9, name: 'Chest tightness', category: 'respiratory' },
            { id: 10, name: 'Coughing blood', category: 'respiratory' },
            { id: 11, name: 'Hoarseness', category: 'respiratory' },
            { id: 12, name: 'Sinus pressure', category: 'respiratory' },
            { id: 13, name: 'Post-nasal drip', category: 'respiratory' },
            { id: 14, name: 'Rapid breathing', category: 'respiratory' },
            { id: 15, name: 'Shallow breathing', category: 'respiratory' },

            // Digestive (20)
            { id: 16, name: 'Nausea', category: 'digestive' },
            { id: 17, name: 'Vomiting', category: 'digestive' },
            { id: 18, name: 'Diarrhea', category: 'digestive' },
            { id: 19, name: 'Constipation', category: 'digestive' },
            { id: 20, name: 'Abdominal pain', category: 'digestive' },
            { id: 21, name: 'Bloating', category: 'digestive' },
            { id: 22, name: 'Heartburn', category: 'digestive' },
            { id: 23, name: 'Loss of appetite', category: 'digestive' },
            { id: 24, name: 'Indigestion', category: 'digestive' },
            { id: 25, name: 'Blood in stool', category: 'digestive' },
            { id: 26, name: 'Black stool', category: 'digestive' },
            { id: 27, name: 'Jaundice', category: 'digestive' },
            { id: 28, name: 'Swollen belly', category: 'digestive' },
            { id: 29, name: 'Excessive thirst', category: 'digestive' },
            { id: 30, name: 'Difficulty swallowing', category: 'digestive' },
            { id: 31, name: 'Belching', category: 'digestive' },
            { id: 32, name: 'Flatulence', category: 'digestive' },
            { id: 33, name: 'Fatty stool', category: 'digestive' },
            { id: 34, name: 'Mucus in stool', category: 'digestive' },
            { id: 35, name: 'Rectal pain', category: 'digestive' },

            // Neurological (20)
            { id: 36, name: 'Headache', category: 'neurological' },
            { id: 37, name: 'Dizziness', category: 'neurological' },
            { id: 38, name: 'Confusion', category: 'neurological' },
            { id: 39, name: 'Seizures', category: 'neurological' },
            { id: 40, name: 'Tremors', category: 'neurological' },
            { id: 41, name: 'Numbness', category: 'neurological' },
            { id: 42, name: 'Weakness', category: 'neurological' },
            { id: 43, name: 'Memory loss', category: 'neurological' },
            { id: 44, name: 'Loss of balance', category: 'neurological' },
            { id: 45, name: 'Fainting', category: 'neurological' },
            { id: 46, name: 'Tingling sensation', category: 'neurological' },
            { id: 47, name: 'Blurred vision', category: 'neurological' },
            { id: 48, name: 'Double vision', category: 'neurological' },
            { id: 49, name: 'Slurred speech', category: 'neurological' },
            { id: 50, name: 'Muscle weakness', category: 'neurological' },
            { id: 51, name: 'Coordination problems', category: 'neurological' },
            { id: 52, name: 'Light sensitivity', category: 'neurological' },
            { id: 53, name: 'Sound sensitivity', category: 'neurological' },
            { id: 54, name: 'Brain fog', category: 'neurological' },
            { id: 55, name: 'Difficulty concentrating', category: 'neurological' },

            // Cardiovascular (15)
            { id: 56, name: 'Palpitations', category: 'cardiovascular' },
            { id: 57, name: 'High BP', category: 'cardiovascular' },
            { id: 58, name: 'Low BP', category: 'cardiovascular' },
            { id: 59, name: 'Irregular heartbeat', category: 'cardiovascular' },
            { id: 60, name: 'Swollen ankles', category: 'cardiovascular' },
            { id: 61, name: 'Cold hands/feet', category: 'cardiovascular' },
            { id: 62, name: 'Cyanosis', category: 'cardiovascular' },
            { id: 63, name: 'Leg pain when walking', category: 'cardiovascular' },
            { id: 64, name: 'Varicose veins', category: 'cardiovascular' },
            { id: 65, name: 'Heart murmur', category: 'cardiovascular' },
            { id: 66, name: 'Chest discomfort', category: 'cardiovascular' },
            { id: 67, name: 'Fatigue with exertion', category: 'cardiovascular' },
            { id: 68, name: 'Night sweats', category: 'cardiovascular' },
            { id: 69, name: 'Fluttering in chest', category: 'cardiovascular' },
            { id: 70, name: 'Shortness of breath lying flat', category: 'cardiovascular' },

            // Muscular/Skeletal (15)
            { id: 71, name: 'Joint pain', category: 'muscular' },
            { id: 72, name: 'Muscle pain', category: 'muscular' },
            { id: 73, name: 'Back pain', category: 'muscular' },
            { id: 74, name: 'Neck pain', category: 'muscular' },
            { id: 75, name: 'Swelling', category: 'muscular' },
            { id: 76, name: 'Stiffness', category: 'muscular' },
            { id: 77, name: 'Muscle cramps', category: 'muscular' },
            { id: 78, name: 'Muscle spasms', category: 'muscular' },
            { id: 79, name: 'Reduced range of motion', category: 'muscular' },
            { id: 80, name: 'Joint stiffness', category: 'muscular' },
            { id: 81, name: 'Muscle twitching', category: 'muscular' },
            { id: 82, name: 'Bone pain', category: 'muscular' },
            { id: 83, name: 'Knee pain', category: 'muscular' },
            { id: 84, name: 'Shoulder pain', category: 'muscular' },
            { id: 85, name: 'Hip pain', category: 'muscular' },

            // Skin (15)
            { id: 86, name: 'Rash', category: 'skin' },
            { id: 87, name: 'Itching', category: 'skin' },
            { id: 88, name: 'Hives', category: 'skin' },
            { id: 89, name: 'Dry skin', category: 'skin' },
            { id: 90, name: 'Blisters', category: 'skin' },
            { id: 91, name: 'Redness', category: 'skin' },
            { id: 92, name: 'Skin peeling', category: 'skin' },
            { id: 93, name: 'Skin discoloration', category: 'skin' },
            { id: 94, name: 'Wounds', category: 'skin' },
            { id: 95, name: 'Ulcers', category: 'skin' },
            { id: 96, name: 'Nail changes', category: 'skin' },
            { id: 97, name: 'Hair loss', category: 'skin' },
            { id: 98, name: 'Skin thickening', category: 'skin' },
            { id: 99, name: 'Bruising', category: 'skin' },
            { id: 100, name: 'Skin bumps', category: 'skin' },

            // General (20)
            { id: 101, name: 'Fever', category: 'general' },
            { id: 102, name: 'Fatigue', category: 'general' },
            { id: 103, name: 'Chills', category: 'general' },
            { id: 104, name: 'Night sweats', category: 'general' },
            { id: 105, name: 'Weight loss', category: 'general' },
            { id: 106, name: 'Weight gain', category: 'general' },
            { id: 107, name: 'Dehydration', category: 'general' },
            { id: 108, name: 'Malaise', category: 'general' },
            { id: 109, name: 'Loss of energy', category: 'general' },
            { id: 110, name: 'Poor appetite', category: 'general' },
            { id: 111, name: 'Insomnia', category: 'general' },
            { id: 112, name: 'Excessive sleep', category: 'general' },
            { id: 113, name: 'Sweating', category: 'general' },
            { id: 114, name: 'Hot flashes', category: 'general' },
            { id: 115, name: 'Thirst', category: 'general' },

            // Infectious (10)
            { id: 116, name: 'Swollen lymph nodes', category: 'infectious' },
            { id: 117, name: 'Body aches', category: 'infectious' },
            { id: 118, name: 'Sore muscles', category: 'infectious' },
            { id: 119, name: 'Enlarged spleen', category: 'infectious' },
            { id: 120, name: 'Enlarged liver', category: 'infectious' },
            { id: 121, name: 'Petechiae', category: 'infectious' },
            { id: 122, name: 'Pus', category: 'infectious' },
            { id: 123, name: 'Abscess', category: 'infectious' },
            { id: 124, name: 'Red streaks', category: 'infectious' },
            { id: 125, name: 'Warm skin', category: 'infectious' },

            // Metabolic (10)
            { id: 126, name: 'Excessive thirst', category: 'metabolic' },
            { id: 127, name: 'Frequent urination', category: 'metabolic' },
            { id: 128, name: 'Blurred vision', category: 'metabolic' },
            { id: 129, name: 'Slow healing', category: 'metabolic' },
            { id: 130, name: 'Tingling in feet', category: 'metabolic' },
            { id: 131, name: 'Fruity breath', category: 'metabolic' },
            { id: 132, name: 'Cold intolerance', category: 'metabolic' },
            { id: 133, name: 'Heat intolerance', category: 'metabolic' },
            { id: 134, name: 'Goiter', category: 'metabolic' },
            { id: 135, name: 'Moon face', category: 'metabolic' },

            // Mental Health (10)
            { id: 136, name: 'Anxiety', category: 'mental' },
            { id: 137, name: 'Depression', category: 'mental' },
            { id: 138, name: 'Panic attacks', category: 'mental' },
            { id: 139, name: 'Mood swings', category: 'mental' },
            { id: 140, name: 'Irritability', category: 'mental' },
            { id: 141, name: 'Hallucinations', category: 'mental' },
            { id: 142, name: 'Paranoia', category: 'mental' },
            { id: 143, name: 'Social withdrawal', category: 'mental' },
            { id: 144, name: 'Compulsive behavior', category: 'mental' },
            { id: 145, name: 'Suicidal thoughts', category: 'mental' }
        ];

        // ==================== EXPANDED DISEASE DATABASE ====================
        const diseasesDB = [
            {
                id: 1,
                name: 'Common Cold',
                symptoms: [1, 5, 6, 7, 8, 101],
                severity: 'low',
                description: 'Viral infection of upper respiratory tract',
                recommendations: ['Rest', 'Hydrate', 'OTC medications', 'Use humidifier'],
                homeRemedies: ['Ginger tea', 'Honey', 'Steam inhalation', 'Salt water gargle'],
                medicines: ['Paracetamol 650mg', 'Cetirizine 10mg', 'Cough syrup'],
                warningSigns: ['High fever >101¬∞F', 'Difficulty breathing', 'Severe headache']
            },
            {
                id: 2,
                name: 'Influenza',
                symptoms: [1, 101, 102, 103, 104, 117],
                severity: 'medium',
                description: 'Viral infection affecting respiratory system',
                recommendations: ['Rest', 'Isolate', 'Antiviral medications', 'Stay hydrated'],
                homeRemedies: ['Warm fluids', 'Honey lemon tea', 'Chicken soup', 'Rest'],
                medicines: ['Oseltamivir 75mg', 'Paracetamol 650mg', 'Cough suppressant'],
                warningSigns: ['Breathing difficulty', 'Chest pain', 'Confusion', 'Severe vomiting']
            },
            {
                id: 3,
                name: 'Gastroenteritis',
                symptoms: [16, 17, 18, 20, 101],
                severity: 'medium',
                description: 'Stomach and intestinal inflammation',
                recommendations: ['ORS', 'Bland diet', 'Rest', 'Avoid dairy'],
                homeRemedies: ['Coconut water', 'Ginger tea', 'Rice water', 'Bananas'],
                medicines: ['ORS packets', 'Zinc 20mg', 'Paracetamol for fever'],
                warningSigns: ['Severe dehydration', 'Blood in stool', 'High fever', 'Unable to keep fluids']
            },
            {
                id: 4,
                name: 'Migraine',
                symptoms: [36, 37, 53, 52, 38],
                severity: 'medium',
                description: 'Severe headache disorder with neurological symptoms',
                recommendations: ['Dark quiet room', 'Avoid triggers', 'Rest', 'Stress management'],
                homeRemedies: ['Cold compress', 'Peppermint oil', 'Caffeine (small amount)', 'Rest in dark room'],
                medicines: ['Sumatriptan', 'Ibuprofen 400mg', 'Paracetamol 650mg'],
                warningSigns: ['Sudden severe headache', 'Neurological symptoms', 'Fever', 'Stiff neck']
            },
            {
                id: 5,
                name: 'Pneumonia',
                symptoms: [1, 2, 4, 101, 102, 3, 42],
                severity: 'high',
                description: 'Infection of lung tissue',
                recommendations: ['Immediate medical attention', 'Antibiotics', 'Rest', 'Oxygen therapy'],
                homeRemedies: ['Steam inhalation', 'Warm compress', 'Honey for cough', 'Hydration'],
                medicines: ['Amoxicillin', 'Azithromycin', 'Paracetamol', 'Cough medicine'],
                warningSigns: ['Severe breathing difficulty', 'Blue lips', 'Chest pain', 'High fever']
            },
            {
                id: 6,
                name: 'Hypertension',
                symptoms: [56, 57, 37, 36, 102],
                severity: 'medium',
                description: 'High blood pressure',
                recommendations: ['Low salt diet', 'Regular exercise', 'Medication', 'Stress reduction'],
                homeRemedies: ['Garlic', 'Hibiscus tea', 'Regular walking', 'Reduce stress'],
                medicines: ['Amlodipine', 'Losartan', 'Hydrochlorothiazide'],
                warningSigns: ['BP >180/120', 'Chest pain', 'Severe headache', 'Shortness of breath']
            },
            {
                id: 7,
                name: 'Type 2 Diabetes',
                symptoms: [126, 127, 128, 102, 105, 130],
                severity: 'medium',
                description: 'Chronic condition affecting blood sugar',
                recommendations: ['Monitor blood sugar', 'Healthy diet', 'Exercise', 'Medication compliance'],
                homeRemedies: ['Fenugreek seeds', 'Bitter gourd', 'Cinnamon', 'Regular walking'],
                medicines: ['Metformin', 'Glibenclamide', 'Insulin'],
                warningSigns: ['Blood sugar >300', 'Confusion', 'Fruity breath', 'Nausea/vomiting']
            },
            {
                id: 8,
                name: 'Arthritis',
                symptoms: [71, 72, 75, 76, 80],
                severity: 'medium',
                description: 'Joint inflammation',
                recommendations: ['Pain management', 'Physical therapy', 'Exercise', 'Joint protection'],
                homeRemedies: ['Hot/cold therapy', 'Gentle exercise', 'Turmeric', 'Epsom salt baths'],
                medicines: ['Ibuprofen', 'Paracetamol', 'Methotrexate'],
                warningSigns: ['Severe joint pain', 'Fever', 'Red/hot joint', 'Difficulty moving']
            },
            {
                id: 9,
                name: 'Eczema',
                symptoms: [86, 87, 89, 91],
                severity: 'low',
                description: 'Inflammatory skin condition',
                recommendations: ['Moisturize', 'Avoid triggers', 'Gentle skin care', 'Identify triggers'],
                homeRemedies: ['Coconut oil', 'Oatmeal baths', 'Aloe vera', 'Avoid hot showers'],
                medicines: ['Hydrocortisone cream', 'Antihistamines', 'Tacrolimus ointment'],
                warningSigns: ['Signs of infection', 'Fever', 'Spreading redness', 'Pain']
            },
            {
                id: 10,
                name: 'Malaria',
                symptoms: [101, 103, 104, 36, 102, 117],
                severity: 'high',
                description: 'Mosquito-borne parasitic disease',
                recommendations: ['Immediate treatment', 'Complete medication course', 'Rest', 'Hydration'],
                homeRemedies: ['Rest', 'Hydration', 'Fever management', 'Nutritious diet'],
                medicines: ['Artemisinin combination', 'Chloroquine', 'Primaquine'],
                warningSigns: ['Severe headache', 'Confusion', 'Seizures', 'Difficulty breathing']
            },
            {
                id: 11,
                name: 'Dengue Fever',
                symptoms: [101, 36, 117, 86, 16, 102],
                severity: 'high',
                description: 'Mosquito-borne viral infection',
                recommendations: ['Rest', 'Hydration', 'Monitor platelet count', 'No NSAIDs'],
                homeRemedies: ['Papaya leaf juice', 'Coconut water', 'Hydration', 'Rest'],
                medicines: ['Paracetamol only', 'IV fluids if severe'],
                warningSigns: ['Severe abdominal pain', 'Bleeding', 'Vomiting', 'Rapid breathing']
            },
            {
                id: 12,
                name: 'Anxiety Disorder',
                symptoms: [136, 138, 140, 143, 56],
                severity: 'medium',
                description: 'Mental health condition causing excessive worry',
                recommendations: ['Therapy', 'Medication', 'Stress management', 'Regular exercise'],
                homeRemedies: ['Deep breathing', 'Meditation', 'Regular sleep', 'Avoid caffeine'],
                medicines: ['Sertraline', 'Escitalopram', 'Alprazolam'],
                warningSigns: ['Suicidal thoughts', 'Panic attacks', 'Unable to function', 'Chest pain']
            }
        ];

        let selectedSymptoms = [];
        let currentCategory = 'all';
        let mediaRecorder = null;
        let audioChunks = [];
        let isRecording = false;
        let recordingSeconds = 0;
        let recordingTimer = null;

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            // Check if user is already logged in
            if (currentUser) {
                showMainApp();
            }
            
            loadDistricts();
            displaySymptoms('all');
            updateStats();
            displayRecords();
        });

        // ==================== AUTHENTICATION ====================
        function switchAuthTab(tab) {
            document.querySelectorAll('.login-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.login-form').forEach(f => f.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + 'Form').classList.add('active');
        }

        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                showMainApp();
                showToast('Login successful!', 'success');
            } else {
                showToast('Invalid email or password', 'error');
            }
        }

        function handleSignup() {
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const phone = document.getElementById('signupPhone').value;
            
            if (!name || !email || !password) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            if (users.find(u => u.email === email)) {
                showToast('Email already exists', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                name,
                email,
                password,
                phone,
                createdAt: new Date().toISOString()
            };
            
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            // Auto login after signup
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            
            showMainApp();
            showToast('Account created successfully!', 'success');
            
            // Clear signup form
            document.getElementById('signupName').value = '';
            document.getElementById('signupEmail').value = '';
            document.getElementById('signupPassword').value = '';
            document.getElementById('signupPhone').value = '';
        }

        function handleForgotPassword() {
            const email = document.getElementById('forgotEmail').value;
            
            if (!email) {
                showToast('Please enter your email', 'error');
                return;
            }
            
            const user = users.find(u => u.email === email);
            
            if (user) {
                // Generate reset token
                const resetToken = Math.random().toString(36).substring(2, 15);
                const resetRequest = {
                    email,
                    token: resetToken,
                    expires: Date.now() + 3600000 // 1 hour
                };
                
                passwordResetRequests.push(resetRequest);
                localStorage.setItem('resetRequests', JSON.stringify(passwordResetRequests));
                
                showToast(`Password reset link sent to ${email}`, 'success');
                
                // Auto fill a demo reset
                setTimeout(() => {
                    const newPassword = prompt('Enter new password (demo):');
                    if (newPassword) {
                        user.password = newPassword;
                        localStorage.setItem('users', JSON.stringify(users));
                        showToast('Password updated successfully!', 'success');
                    }
                }, 2000);
            } else {
                showToast('Email not found', 'error');
            }
            
            document.getElementById('forgotEmail').value = '';
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            
            document.getElementById('mainApp').classList.remove('visible');
            document.getElementById('loginPage').style.display = 'flex';
            
            showToast('Logged out successfully', 'success');
        }

        function showMainApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainApp').classList.add('visible');
            
            // Update stats
            document.getElementById('totalUsers').textContent = users.length;
            updateStats();
        }

        // ==================== LANGUAGE ====================
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update UI text
            const t = translations[lang] || translations.en;
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) el.textContent = t[key];
            });
            
            // Update voice status
            document.getElementById('voiceStatus').innerHTML = `<i class="fas fa-info-circle"></i> Click the microphone and speak in ${lang === 'en' ? 'English' : lang === 'hi' ? 'Hindi' : lang === 'ta' ? 'Tamil' : lang === 'te' ? 'Telugu' : lang === 'kn' ? 'Kannada' : 'Malayalam'}`;
            
            showToast(`Language switched to ${lang}`, 'success');
        }

        // ==================== DISTRICTS ====================
        function loadDistricts() {
            const select = document.getElementById('patientDistrict');
            districts.forEach(d => {
                const option = document.createElement('option');
                option.value = d;
                option.textContent = d;
                select.appendChild(option);
            });
        }

        // ==================== SYMPTOMS ====================
        function displaySymptoms(category) {
            const grid = document.getElementById('symptomsGrid');
            grid.innerHTML = '';
            
            const filtered = category === 'all' ? symptomsDB : symptomsDB.filter(s => s.category === category);
            
            filtered.forEach(symptom => {
                const item = document.createElement('div');
                item.className = `symptom-item ${selectedSymptoms.includes(symptom.id) ? 'selected' : ''}`;
                item.onclick = () => toggleSymptom(symptom.id);
                
                item.innerHTML = `
                    <input type="checkbox" ${selectedSymptoms.includes(symptom.id) ? 'checked' : ''}>
                    <span>${symptom.name}</span>
                `;
                
                grid.appendChild(item);
            });
            
            // Update count
            document.querySelector('.category-tab.active').textContent = 
                `${currentCategory.charAt(0).toUpperCase() + currentCategory.slice(1)} (${filtered.length})`;
        }

        function filterSymptoms(category) {
            currentCategory = category;
            document.querySelectorAll('.category-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            displaySymptoms(category);
        }

        function toggleSymptom(id) {
            const index = selectedSymptoms.indexOf(id);
            if (index === -1) {
                selectedSymptoms.push(id);
            } else {
                selectedSymptoms.splice(index, 1);
            }
            updateSymptomTags();
            displaySymptoms(currentCategory);
        }

        function updateSymptomTags() {
            const container = document.getElementById('symptomTags');
            
            if (selectedSymptoms.length === 0) {
                container.innerHTML = '<p style="color: var(--gray);">No symptoms selected</p>';
                return;
            }
            
            container.innerHTML = '';
            selectedSymptoms.forEach(id => {
                const symptom = symptomsDB.find(s => s.id === id);
                if (symptom) {
                    const tag = document.createElement('span');
                    tag.className = 'symptom-tag';
                    tag.innerHTML = `${symptom.name} <button onclick="removeSymptom(${id})">√ó</button>`;
                    container.appendChild(tag);
                }
            });
        }

        function removeSymptom(id) {
            const index = selectedSymptoms.indexOf(id);
            if (index !== -1) {
                selectedSymptoms.splice(index, 1);
                updateSymptomTags();
                displaySymptoms(currentCategory);
            }
        }

        function clearSelection() {
            selectedSymptoms = [];
            updateSymptomTags();
            displaySymptoms(currentCategory);
            document.getElementById('symptomsText').value = '';
            showToast('Selection cleared', 'success');
        }

        // ==================== VOICE RECORDING ====================
        async function toggleRecording() {
            if (!isRecording) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    audioChunks = [];
                    
                    mediaRecorder.ondataavailable = (e) => {
                        audioChunks.push(e.data);
                    };
                    
                    mediaRecorder.onstop = () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                        
                        // Simulate voice-to-text based on current language
                        const texts = {
                            en: 'cough, fever, headache, fatigue',
                            hi: '‡§ñ‡§æ‡§Ç‡§∏‡•Ä, ‡§¨‡•Å‡§ñ‡§æ‡§∞, ‡§∏‡§ø‡§∞‡§¶‡§∞‡•ç‡§¶, ‡§•‡§ï‡§æ‡§®',
                            ta: '‡Æá‡Æ∞‡ØÅ‡ÆÆ‡Æ≤‡Øç, ‡Æï‡Ææ‡ÆØ‡Øç‡Æö‡Øç‡Æö‡Æ≤‡Øç, ‡Æ§‡Æ≤‡Øà‡Æµ‡Æ≤‡Æø, ‡Æö‡Øã‡Æ∞‡Øç‡Æµ‡ØÅ',
                            te: '‡∞¶‡∞ó‡±ç‡∞ó‡±Å, ‡∞ú‡±ç‡∞µ‡∞∞‡∞Ç, ‡∞§‡∞≤‡∞®‡±ä‡∞™‡±ç‡∞™‡∞ø, ‡∞Ö‡∞≤‡∞∏‡∞ü',
                            kn: '‡≤ï‡≥Ü‡≤Æ‡≥ç‡≤Æ‡≥Å, ‡≤ú‡≥ç‡≤µ‡≤∞, ‡≤§‡≤≤‡≥Ü‡≤®‡≥ã‡≤µ‡≥Å, ‡≤Ü‡≤Ø‡≤æ‡≤∏',
                            ml: '‡¥ö‡µÅ‡¥Æ, ‡¥™‡¥®‡¥ø, ‡¥§‡¥≤‡¥µ‡µá‡¥¶‡¥®, ‡¥ï‡µç‡¥∑‡µÄ‡¥£‡¥Ç'
                        };
                        
                        document.getElementById('symptomsText').value = texts[currentLanguage] || texts.en;
                        
                        stream.getTracks().forEach(track => track.stop());
                    };
                    
                    mediaRecorder.start();
                    isRecording = true;
                    
                    document.getElementById('recordBtn').classList.add('recording');
                    document.getElementById('recordBtn').innerHTML = '<i class="fas fa-stop"></i>';
                    
                    recordingSeconds = 0;
                    recordingTimer = setInterval(() => {
                        recordingSeconds++;
                        const mins = Math.floor(recordingSeconds / 60);
                        const secs = recordingSeconds % 60;
                        document.getElementById('timer').textContent = 
                            `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                    }, 1000);
                    
                } catch (err) {
                    showToast('Please allow microphone access', 'error');
                }
            } else {
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                }
                clearInterval(recordingTimer);
                isRecording = false;
                document.getElementById('recordBtn').classList.remove('recording');
                document.getElementById('recordBtn').innerHTML = '<i class="fas fa-microphone"></i>';
                showToast('Recording completed!', 'success');
            }
        }

        // ==================== PATIENT RECORDS ====================
        function displayRecords() {
            const tbody = document.getElementById('recordsBody');
            
            if (diagnoses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" style="text-align: center;">No records yet</td></tr>';
                return;
            }
            
            // Sort by date (newest first)
            const sorted = [...diagnoses].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            tbody.innerHTML = sorted.map(d => {
                const date = new Date(d.date).toLocaleString();
                const symptomsList = d.symptoms ? d.symptoms.map(id => {
                    const s = symptomsDB.find(sym => sym.id === id);
                    return s ? s.name : '';
                }).filter(name => name).join(', ') : 'N/A';
                
                return `
                    <tr>
                        <td>${date}</td>
                        <td>${d.patientName}</td>
                        <td>${d.patientAge || 'N/A'}</td>
                        <td>${d.patientGender || 'N/A'}</td>
                        <td>${d.district || 'N/A'}</td>
                        <td>${d.diagnosis}</td>
                        <td><span class="severity-badge severity-${d.severity}">${d.severity.toUpperCase()}</span></td>
                        <td>${symptomsList.substring(0, 30)}${symptomsList.length > 30 ? '...' : ''}</td>
                        <td><button class="view-btn" onclick="viewRecord(${d.id})"><i class="fas fa-eye"></i> View</button></td>
                    </tr>
                `;
            }).join('');
        }

        function searchRecords() {
            const searchTerm = document.getElementById('recordSearch').value.toLowerCase();
            const tbody = document.getElementById('recordsBody');
            
            const filtered = diagnoses.filter(d => 
                d.patientName.toLowerCase().includes(searchTerm) ||
                d.diagnosis.toLowerCase().includes(searchTerm) ||
                (d.district && d.district.toLowerCase().includes(searchTerm))
            );
            
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" style="text-align: center;">No matching records</td></tr>';
                return;
            }
            
            tbody.innerHTML = filtered.map(d => {
                const date = new Date(d.date).toLocaleString();
                const symptomsList = d.symptoms ? d.symptoms.map(id => {
                    const s = symptomsDB.find(sym => sym.id === id);
                    return s ? s.name : '';
                }).filter(name => name).join(', ') : 'N/A';
                
                return `
                    <tr>
                        <td>${date}</td>
                        <td>${d.patientName}</td>
                        <td>${d.patientAge || 'N/A'}</td>
                        <td>${d.patientGender || 'N/A'}</td>
                        <td>${d.district || 'N/A'}</td>
                        <td>${d.diagnosis}</td>
                        <td><span class="severity-badge severity-${d.severity}">${d.severity.toUpperCase()}</span></td>
                        <td>${symptomsList.substring(0, 30)}${symptomsList.length > 30 ? '...' : ''}</td>
                        <td><button class="view-btn" onclick="viewRecord(${d.id})"><i class="fas fa-eye"></i> View</button></td>
                    </tr>
                `;
            }).join('');
        }

        function viewRecord(id) {
            const record = diagnoses.find(d => d.id === id);
            if (record) {
                // Display full record details
                const symptomsList = record.symptoms ? record.symptoms.map(id => {
                    const s = symptomsDB.find(sym => sym.id === id);
                    return s ? s.name : '';
                }).filter(name => name).join(', ') : 'N/A';
                
                alert(`
Patient: ${record.patientName}
Age: ${record.patientAge || 'N/A'}
Gender: ${record.patientGender || 'N/A'}
District: ${record.district || 'N/A'}
Date: ${new Date(record.date).toLocaleString()}
Diagnosis: ${record.diagnosis}
Severity: ${record.severity.toUpperCase()}
Symptoms: ${symptomsList}
                `);
            }
        }

        function clearAllRecords() {
            if (confirm('Are you sure you want to delete all records? This cannot be undone.')) {
                diagnoses = [];
                localStorage.setItem('diagnoses', JSON.stringify(diagnoses));
                displayRecords();
                updateStats();
                showToast('All records cleared', 'success');
            }
        }

        function exportRecords() {
            const dataStr = JSON.stringify(diagnoses, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `ruralcare_records_${new Date().toISOString().slice(0,10)}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showToast('Records exported successfully', 'success');
        }

        function loadSamplePatient() {
            document.getElementById('patientName').value = 'Ravi Kumar';
            document.getElementById('patientAge').value = '45';
            document.getElementById('patientGender').value = 'male';
            document.getElementById('patientDistrict').value = 'Chennai';
            document.getElementById('symptomsText').value = 'cough, fever, fatigue';
            
            // Select some symptoms
            selectedSymptoms = [1, 101, 102];
            updateSymptomTags();
            displaySymptoms(currentCategory);
            
            showToast('Sample patient loaded', 'success');
        }

        // ==================== AI DIAGNOSIS ====================
        function analyzeHealth() {
            // Validate form
            const name = document.getElementById('patientName').value;
            const age = document.getElementById('patientAge').value;
            const gender = document.getElementById('patientGender').value;
            const district = document.getElementById('patientDistrict').value;
            
            if (!name || !age || !district) {
                showToast('Please fill patient details', 'error');
                return;
            }
            
            // Get typed symptoms
            const typedText = document.getElementById('symptomsText').value.toLowerCase();
            const typedSymptoms = typedText.split(',').map(s => s.trim()).filter(s => s);
            
            // Combine with selected symptoms
            let allSymptoms = [...selectedSymptoms];
            
            typedSymptoms.forEach(text => {
                // Find matching symptoms from database
                symptomsDB.forEach(symptom => {
                    if (symptom.name.toLowerCase().includes(text) && !allSymptoms.includes(symptom.id)) {
                        allSymptoms.push(symptom.id);
                    }
                });
            });
            
            if (allSymptoms.length === 0) {
                showToast('Please select or type symptoms', 'error');
                return;
            }
            
            // Find best matching disease
            let bestMatch = null;
            let bestScore = 0;
            let matches = [];
            
            diseasesDB.forEach(disease => {
                const matches_count = disease.symptoms.filter(s => allSymptoms.includes(s)).length;
                const score = (matches_count / disease.symptoms.length) * 100;
                
                matches.push({
                    disease: disease,
                    score: score,
                    matches: matches_count,
                    total: disease.symptoms.length
                });
                
                if (score > bestScore) {
                    bestScore = score;
                    bestMatch = disease;
                }
            });
            
            if (!bestMatch) {
                bestMatch = diseasesDB[0];
                bestScore = 30;
            }
            
            // Sort matches by score
            matches.sort((a, b) => b.score - a.score);
            
            // Display results
            displayResults(bestMatch, bestScore, allSymptoms, matches.slice(0, 3));
            
            // Save diagnosis
            const diagnosis = {
                id: Date.now(),
                patientName: name,
                patientAge: age,
                patientGender: gender,
                district: district,
                diagnosis: bestMatch.name,
                severity: bestMatch.severity,
                symptoms: allSymptoms,
                date: new Date().toISOString(),
                userId: currentUser?.id,
                score: Math.round(bestScore)
            };
            
            diagnoses.push(diagnosis);
            localStorage.setItem('diagnoses', JSON.stringify(diagnoses));
            updateStats();
            displayRecords();
            
            showToast('Analysis complete!', 'success');
        }

        function displayResults(disease, score, symptoms, topMatches) {
            const resultsDiv = document.getElementById('results');
            const severityClass = `severity-${disease.severity}`;
            
            const matchedSymptoms = disease.symptoms
                .filter(id => symptoms.includes(id))
                .map(id => symptomsDB.find(s => s.id === id)?.name)
                .filter(name => name);
            
            const allSymptomNames = symptoms
                .map(id => symptomsDB.find(s => s.id === id)?.name)
                .filter(name => name);
            
            let html = `
                <h2 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-robot"></i> AI Diagnosis Report
                </h2>
                
                <div style="margin-bottom: 20px; padding: 20px; background: var(--background); border-radius: 20px;">
                    <h3>${disease.name}</h3>
                    <span class="severity-badge ${severityClass}">${disease.severity.toUpperCase()}</span>
                    <p style="margin-top: 10px;">${disease.description}</p>
                    <p><strong>Match Confidence:</strong> ${Math.round(score)}%</p>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>‚úÖ Your Reported Symptoms (${allSymptomNames.length}):</h4>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
                        ${allSymptomNames.map(s => `<span style="background: var(--primary); color: white; padding: 5px 15px; border-radius: 20px;">${s}</span>`).join('')}
                    </div>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>üéØ Matching Symptoms for ${disease.name}:</h4>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
                        ${matchedSymptoms.map(s => `<span style="background: var(--success); color: white; padding: 5px 15px; border-radius: 20px;">${s}</span>`).join('')}
                        ${disease.symptoms.filter(id => !symptoms.includes(id)).map(id => {
                            const s = symptomsDB.find(sym => sym.id === id);
                            return s ? `<span style="background: var(--border); color: var(--text-secondary); padding: 5px 15px; border-radius: 20px;">${s.name}</span>` : '';
                        }).join('')}
                    </div>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>üìã Recommendations:</h4>
                    <ul style="margin-left: 20px;">${disease.recommendations.map(r => `<li>${r}</li>`).join('')}</ul>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>üè† Home Remedies:</h4>
                    <ul style="margin-left: 20px;">${disease.homeRemedies.map(r => `<li>${r}</li>`).join('')}</ul>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>üíä Prescription Medicines:</h4>
                    <ul style="margin-left: 20px;">${disease.medicines.map(m => `<li>${m}</li>`).join('')}</ul>
                    <p style="font-size: 0.8rem; color: var(--danger); margin-top: 5px;">‚ö†Ô∏è Prescription required - Consult doctor</p>
                </div>
            `;
            
            if (disease.severity === 'high') {
                html += `
                    <div style="background: #fee2e2; padding: 20px; border-radius: 20px; margin: 20px 0;">
                        <h4 style="color: var(--danger);"><i class="fas fa-exclamation-triangle"></i> CONSULT DOCTOR IMMEDIATELY</h4>
                        <ul style="margin-left: 20px; color: var(--danger);">${disease.warningSigns.map(s => `<li>${s}</li>`).join('')}</ul>
                    </div>
                `;
            }
            
            if (topMatches && topMatches.length > 1) {
                html += `
                    <div style="margin: 20px 0; padding: 15px; background: var(--light); border-radius: 20px;">
                        <h4>üìä Other Possible Conditions:</h4>
                        ${topMatches.slice(1).map(m => `
                            <div style="margin: 10px 0; padding: 10px; background: white; border-radius: 10px;">
                                <strong>${m.disease.name}</strong> - ${Math.round(m.score)}% match
                                <br><small>${m.disease.description}</small>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            html += `
                <div style="margin-top: 30px; display: flex; gap: 15px; flex-wrap: wrap;">
                    <button class="login-btn" onclick="window.print()" style="width: auto; padding: 12px 30px;">
                        <i class="fas fa-print"></i> Print Report
                    </button>
                    <button class="login-btn" onclick="saveToLocal()" style="width: auto; padding: 12px 30px; background: var(--secondary);">
                        <i class="fas fa-save"></i> Save Report
                    </button>
                    <button class="login-btn" onclick="document.getElementById('results').style.display='none'" style="width: auto; padding: 12px 30px; background: var(--gray);">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            `;
            
            resultsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function saveToLocal() {
            showToast('Report saved to local storage', 'success');
        }

        // ==================== STATS ====================
        function updateStats() {
            document.getElementById('totalUsers').textContent = users.length;
            document.getElementById('totalDiagnoses').textContent = diagnoses.length;
            document.getElementById('highRiskCount').textContent = diagnoses.filter(d => d.severity === 'high').length;
            document.getElementById('todayCount').textContent = diagnoses.filter(d => 
                new Date(d.date).toDateString() === new Date().toDateString()
            ).length;
        }

        // ==================== TOAST ====================
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast show ${type}`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>
