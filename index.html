<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>RuralCare Pro - Complete Healthcare Platform with Working Voice</title>
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        :root {
            --primary: #0d9488;
            --primary-dark: #0f766e;
            --primary-light: #14b8a6;
            --secondary: #8b5cf6;
            --accent: #f59e0b;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f97316;
            --info: #3b82f6;
            --background: #f0fdfa;
            --surface: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-light: #94a3b8;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }

        body {
            background: linear-gradient(135deg, #f0fdfa 0%, #e6fffa 100%);
            color: var(--text-primary);
            min-height: 100vh;
            font-size: 16px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ========== LOGIN PAGE STYLES ========== */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 48px;
            padding: 48px;
            max-width: 500px;
            width: 100%;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(13, 148, 136, 0.2);
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-header h1 {
            color: var(--primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .login-header p {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .login-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 10px;
        }

        .login-tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 30px;
            transition: all 0.3s;
        }

        .login-tab.active {
            background: var(--primary);
            color: white;
        }

        .login-form {
            display: none;
        }

        .login-form.active {
            display: block;
        }

        .input-group {
            position: relative;
            margin-bottom: 25px;
        }

        .input-group i {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            font-size: 1.2rem;
            z-index: 1;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 16px 16px 16px 50px;
            border: 2px solid var(--border);
            border-radius: 60px;
            font-size: 1rem;
            background: white;
            transition: all 0.3s;
        }

        .input-group textarea {
            border-radius: 30px;
            resize: vertical;
        }

        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(13, 148, 136, 0.1);
        }

        .input-group label {
            position: absolute;
            left: 50px;
            top: -10px;
            background: white;
            padding: 0 8px;
            font-size: 0.8rem;
            color: var(--primary);
            font-weight: 600;
            border-radius: 20px;
            opacity: 0;
            transition: 0.2s;
        }

        .input-group input:focus + label,
        .input-group input:not(:placeholder-shown) + label,
        .input-group textarea:focus + label,
        .input-group textarea:not(:placeholder-shown) + label {
            opacity: 1;
            top: -10px;
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 60px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 20px -5px var(--primary);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px -5px var(--primary);
        }

        .forgot-link {
            text-align: right;
            margin: 10px 0;
        }

        .forgot-link a {
            color: var(--primary);
            text-decoration: none;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .forgot-link a:hover {
            text-decoration: underline;
        }

        /* ========== MAIN APP STYLES ========== */
        .main-app {
            display: none;
        }

        .main-app.visible {
            display: block;
        }

        /* Language Switcher */
        .language-bar {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .lang-btn {
            padding: 10px 20px;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .lang-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Premium Header */
        .premium-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 40px;
            padding: 40px;
            margin-bottom: 30px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .premium-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 80%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            transform: rotate(30deg);
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header-content h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logout-btn {
            position: absolute;
            top: 30px;
            right: 40px;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            padding: 10px 25px;
            border-radius: 40px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            z-index: 2;
        }

        .logout-btn:hover {
            background: white;
            color: var(--primary);
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 24px;
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow-lg);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Patient Card */
        .patient-card {
            background: white;
            border-radius: 32px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
        }

        .patient-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        /* Voice Section - FIXED */
        .voice-section {
            background: linear-gradient(135deg, #e0f2fe, #bae6fd);
            border-radius: 40px;
            padding: 30px;
            margin: 30px 0;
        }

        .voice-controls {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .record-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--danger);
            color: white;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .record-btn.recording {
            animation: pulse 1.5s infinite;
            background: #b91c1c;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .voice-status {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 10px;
            padding: 10px;
            background: white;
            border-radius: 30px;
            text-align: center;
        }

        .voice-transcript {
            background: white;
            border-radius: 30px;
            padding: 20px;
            margin-top: 20px;
            font-size: 1.1rem;
            border: 2px solid var(--primary);
        }

        .voice-transcript span {
            color: var(--primary);
            font-weight: 600;
        }

        /* Symptoms Section */
        .symptoms-section {
            background: white;
            border-radius: 32px;
            padding: 24px;
            margin: 30px 0;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .category-tab {
            padding: 10px 20px;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-tab.active {
            background: var(--primary);
            color: white;
        }

        .symptoms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }

        .symptom-item {
            padding: 12px;
            background: var(--background);
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
        }

        .symptom-item.selected {
            background: var(--primary);
            color: white;
        }

        .symptom-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .symptom-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .symptom-tag {
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .symptom-tag button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Analyze Button */
        .analyze-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, var(--accent), var(--warning));
            color: white;
            border: none;
            border-radius: 60px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            margin: 30px 0;
            box-shadow: 0 10px 30px -5px var(--accent);
            transition: all 0.3s;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px -5px var(--accent);
        }

        /* Results Card */
        .results-card {
            background: white;
            border-radius: 32px;
            padding: 32px;
            margin: 30px 0;
            box-shadow: var(--shadow-xl);
            display: none;
        }

        .severity-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: 600;
        }

        .severity-low { background: #dcfce7; color: #166534; }
        .severity-medium { background: #fed7aa; color: #9a3412; }
        .severity-high { background: #fee2e2; color: #991b1b; }

        /* Doctor Panel Styles */
        .doctor-section {
            margin-top: 50px;
            border-top: 3px solid var(--primary);
            padding-top: 30px;
        }

        .doctor-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .doctor-header h2 {
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .doctor-login-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .doctor-panel {
            background: white;
            border-radius: 32px;
            padding: 30px;
            margin-top: 20px;
            display: none;
        }

        .doctor-panel.visible {
            display: block;
        }

        .doctor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .doctor-card {
            background: var(--background);
            border-radius: 24px;
            padding: 20px;
            border: 2px solid var(--border);
        }

        .doctor-note {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 20px;
            margin: 15px 0;
            resize: vertical;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(200px);
            background: white;
            padding: 16px 32px;
            border-radius: 60px;
            box-shadow: var(--shadow-xl);
            border-left: 4px solid var(--success);
            transition: transform 0.3s;
            z-index: 2000;
            font-weight: 500;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .login-card {
                padding: 30px;
            }
            
            .header-content h1 {
                font-size: 1.8rem;
            }
            
            .logout-btn {
                position: static;
                margin-top: 20px;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div class="login-container" id="loginPage">
        <div class="login-card">
            <div class="login-header">
                <h1>
                    <i class="fas fa-leaf"></i>
                    RuralCare Pro
                </h1>
                <p>Your Complete Healthcare Assistant</p>
            </div>

            <div class="login-tabs">
                <button class="login-tab active" onclick="switchAuthTab('login')">Login</button>
                <button class="login-tab" onclick="switchAuthTab('signup')">Sign Up</button>
                <button class="login-tab" onclick="switchAuthTab('forgot')">Forgot</button>
            </div>

            <!-- Login Form -->
            <div class="login-form active" id="loginForm">
                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="loginEmail" placeholder=" " value="patient@example.com">
                    <label>Email</label>
                </div>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="loginPassword" placeholder=" " value="123456">
                    <label>Password</label>
                </div>
                <div class="forgot-link">
                    <a onclick="switchAuthTab('forgot')">Forgot Password?</a>
                </div>
                <button class="login-btn" onclick="handleLogin()">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
            </div>

            <!-- Signup Form -->
            <div class="login-form" id="signupForm">
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="signupName" placeholder=" ">
                    <label>Full Name</label>
                </div>
                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="signupEmail" placeholder=" ">
                    <label>Email</label>
                </div>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="signupPassword" placeholder=" ">
                    <label>Password</label>
                </div>
                <div class="input-group">
                    <i class="fas fa-phone"></i>
                    <input type="text" id="signupPhone" placeholder=" ">
                    <label>Phone</label>
                </div>
                <button class="login-btn" onclick="handleSignup()">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
            </div>

            <!-- Forgot Password Form -->
            <div class="login-form" id="forgotForm">
                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="forgotEmail" placeholder=" ">
                    <label>Email</label>
                </div>
                <button class="login-btn" onclick="handleForgotPassword()">
                    <i class="fas fa-paper-plane"></i> Send Reset Link
                </button>
                <p style="text-align: center; margin-top: 20px; font-size: 0.9rem; color: var(--text-secondary);">
                    We'll send a password reset link to your email
                </p>
            </div>
        </div>
    </div>

    <!-- MAIN APPLICATION -->
    <div class="main-app" id="mainApp">
        <div class="container">
            <!-- Logout Button -->
            <button class="logout-btn" onclick="handleLogout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>

            <!-- Language Switcher -->
            <div class="language-bar">
                <button class="lang-btn active" onclick="switchLanguage('en')">üá¨üáß English</button>
                <button class="lang-btn" onclick="switchLanguage('hi')">üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
                <button class="lang-btn" onclick="switchLanguage('ta')">üáÆüá≥ ‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
                <button class="lang-btn" onclick="switchLanguage('te')">üáÆüá≥ ‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</button>
                <button class="lang-btn" onclick="switchLanguage('kn')">üáÆüá≥ ‡≤ï‡≤®‡≥ç‡≤®‡≤°</button>
                <button class="lang-btn" onclick="switchLanguage('ml')">üáÆüá≥ ‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
            </div>

            <!-- Premium Header -->
            <header class="premium-header">
                <div class="header-content">
                    <h1>
                        <i class="fas fa-leaf"></i>
                        <span data-i18n="appName">RuralCare Pro</span>
                    </h1>
                    <p data-i18n="appSubtitle">AI-Powered Healthcare Assistant</p>
                </div>
            </header>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalUsers">0</div>
                    <div class="stat-label" data-i18n="totalUsers">Total Users</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalDiagnoses">0</div>
                    <div class="stat-label" data-i18n="totalDiagnoses">Diagnoses</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="highRiskCount">0</div>
                    <div class="stat-label" data-i18n="highRisk">High Risk</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="todayCount">0</div>
                    <div class="stat-label" data-i18n="today">Today</div>
                </div>
            </div>

            <!-- Patient Information -->
            <div class="patient-card">
                <h2 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-user-circle"></i> 
                    <span data-i18n="patientInfo">Patient Information</span>
                </h2>
                <div class="patient-grid">
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="patientName" placeholder=" " value="John Doe">
                        <label data-i18n="fullName">Full Name</label>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-calendar-alt"></i>
                        <input type="number" id="patientAge" placeholder=" " value="35">
                        <label data-i18n="age">Age</label>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-venus-mars"></i>
                        <select id="patientGender">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-map-marker-alt"></i>
                        <select id="patientDistrict">
                            <option value="">Select District</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- VOICE SECTION - FIXED MULTILINGUAL -->
            <div class="voice-section">
                <h2 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-microphone-alt"></i>
                    <span data-i18n="voiceTitle">Voice Symptom Recorder</span>
                </h2>
                
                <div class="voice-controls">
                    <button class="record-btn" id="recordBtn" onclick="toggleRecording()">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <div style="flex: 1;">
                        <div style="background: white; border-radius: 40px; padding: 15px; text-align: center;">
                            <span class="timer" id="timer">00:00</span>
                        </div>
                    </div>
                </div>
                
                <div class="voice-status" id="voiceStatus">
                    <i class="fas fa-info-circle"></i> Click the microphone and speak in your language
                </div>

                <!-- Voice Transcript Display -->
                <div class="voice-transcript" id="voiceTranscript">
                    <span>Recognized Speech:</span> <span id="recognizedText">None yet</span>
                </div>

                <div style="margin-top: 20px;">
                    <div class="input-group">
                        <i class="fas fa-pen"></i>
                        <textarea id="symptomsText" placeholder=" " rows="2"></textarea>
                        <label data-i18n="typeSymptoms">Or type your symptoms (comma separated)</label>
                    </div>
                </div>
            </div>

            <!-- Symptom Checker -->
            <div class="symptoms-section">
                <h2 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-stethoscope"></i>
                    <span data-i18n="symptomChecker">Symptom Checker</span>
                </h2>

                <div class="category-tabs" id="symptomCategories">
                    <button class="category-tab active" onclick="filterSymptoms('all')">All</button>
                    <button class="category-tab" onclick="filterSymptoms('respiratory')">Respiratory</button>
                    <button class="category-tab" onclick="filterSymptoms('digestive')">Digestive</button>
                    <button class="category-tab" onclick="filterSymptoms('neurological')">Neurological</button>
                    <button class="category-tab" onclick="filterSymptoms('general')">General</button>
                </div>

                <div class="symptoms-grid" id="symptomsGrid"></div>

                <div style="margin-top: 20px;">
                    <h4>Selected Symptoms:</h4>
                    <div class="symptom-tags" id="symptomTags"></div>
                </div>
            </div>

            <!-- Analyze Button -->
            <button class="analyze-btn" onclick="analyzeHealth()" id="analyzeBtn">
                <i class="fas fa-microchip"></i>
                <span data-i18n="analyze">Run AI Diagnosis</span>
            </button>

            <!-- Results -->
            <div class="results-card" id="results"></div>

            <!-- DOCTOR SECTION - Separate Login -->
            <div class="doctor-section">
                <div class="doctor-header">
                    <h2>
                        <i class="fas fa-user-md"></i>
                        Doctor's Portal
                    </h2>
                    <button class="doctor-login-btn" onclick="toggleDoctorPanel()" id="doctorToggleBtn">
                        <i class="fas fa-lock"></i> Login as Doctor
                    </button>
                </div>

                <!-- Doctor Login Panel -->
                <div class="doctor-panel" id="doctorPanel">
                    <h3 style="color: var(--primary); margin-bottom: 20px;">Doctor Login</h3>
                    <div class="input-group">
                        <i class="fas fa-user-md"></i>
                        <input type="text" id="doctorUsername" placeholder=" " value="doctor">
                        <label>Username</label>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="doctorPassword" placeholder=" " value="123">
                        <label>Password</label>
                    </div>
                    <button class="login-btn" onclick="doctorLogin()" style="margin-bottom: 20px;">
                        <i class="fas fa-sign-in-alt"></i> Access Doctor Dashboard
                    </button>

                    <!-- Doctor Dashboard (shown after login) -->
                    <div id="doctorDashboard" style="display: none;">
                        <h4 style="margin: 20px 0;">Patient Records</h4>
                        <div class="doctor-grid" id="doctorPatientList"></div>
                        
                        <h4 style="margin: 20px 0;">Add Clinical Note</h4>
                        <textarea class="doctor-note" id="doctorNote" placeholder="Write your recommendations..."></textarea>
                        <button class="login-btn" onclick="saveDoctorNote()">Save Note</button>
                        
                        <button class="login-btn" onclick="doctorLogout()" style="background: var(--danger); margin-top: 20px;">Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // ==================== SERVER SIMULATION ====================
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let diagnoses = JSON.parse(localStorage.getItem('diagnoses')) || [];
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let doctorLoggedIn = false;

        // ==================== MULTI-LANGUAGE SUPPORT ====================
        let currentLanguage = 'en';
        
        const translations = {
            en: {
                appName: 'RuralCare Pro',
                appSubtitle: 'AI-Powered Healthcare Assistant',
                totalUsers: 'Total Users',
                totalDiagnoses: 'Diagnoses',
                highRisk: 'High Risk',
                today: 'Today',
                patientInfo: 'Patient Information',
                fullName: 'Full Name',
                age: 'Age',
                voiceTitle: 'Voice Symptom Recorder',
                typeSymptoms: 'Or type your symptoms (comma separated)',
                symptomChecker: 'Symptom Checker',
                analyze: 'Run AI Diagnosis'
            },
            hi: {
                appName: '‡§∞‡•Ç‡§∞‡§≤‡§ï‡•á‡§Ø‡§∞ ‡§™‡•ç‡§∞‡•ã',
                appSubtitle: '‡§è‡§Ü‡§à-‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡§π‡§æ‡§Ø‡§ï',
                totalUsers: '‡§ï‡•Å‡§≤ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ',
                totalDiagnoses: '‡§®‡§ø‡§¶‡§æ‡§®',
                highRisk: '‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ',
                today: '‡§Ü‡§ú',
                patientInfo: '‡§∞‡•ã‡§ó‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä',
                fullName: '‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ',
                age: '‡§Ü‡§Ø‡•Å',
                voiceTitle: '‡§Ü‡§µ‡§æ‡§ú ‡§≤‡§ï‡•ç‡§∑‡§£ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡§∞',
                typeSymptoms: '‡§Ø‡§æ ‡§Ö‡§™‡§®‡•á ‡§≤‡§ï‡•ç‡§∑‡§£ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç (‡§Ö‡§≤‡•ç‡§™‡§µ‡§ø‡§∞‡§æ‡§Æ ‡§∏‡•á)',
                symptomChecker: '‡§≤‡§ï‡•ç‡§∑‡§£ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§ï',
                analyze: '‡§è‡§Ü‡§à ‡§®‡§ø‡§¶‡§æ‡§® ‡§ö‡§≤‡§æ‡§è‡§Ç'
            },
            ta: {
                appName: '‡Æ∞‡ØÇ‡Æ∞‡Æ≤‡Øç‡Æï‡Øá‡Æ∞‡Øç ‡Æ™‡ØÅ‡Æ∞‡Øã',
                appSubtitle: '‡Æè‡Æê-‡Æá‡ÆØ‡Æô‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æâ‡Æ§‡Æµ‡Æø‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç',
                totalUsers: '‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ ‡Æ™‡ÆØ‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç',
                totalDiagnoses: '‡Æ®‡Øã‡ÆØ‡Æ±‡Æø‡Æ§‡Æ≤‡Øç‡Æï‡Æ≥‡Øç',
                highRisk: '‡ÆÖ‡Æ§‡Æø‡Æï ‡ÆÜ‡Æ™‡Æ§‡Øç‡Æ§‡ØÅ',
                today: '‡Æá‡Æ©‡Øç‡Æ±‡ØÅ',
                patientInfo: '‡Æ®‡Øã‡ÆØ‡Ææ‡Æ≥‡Æø ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç',
                fullName: '‡ÆÆ‡ØÅ‡Æ¥‡ØÅ ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç',
                age: '‡Æµ‡ÆØ‡Æ§‡ØÅ',
                voiceTitle: '‡Æï‡ØÅ‡Æ∞‡Æ≤‡Øç ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø ‡Æ™‡Æ§‡Æø‡Æµ‡Æø',
                typeSymptoms: '‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øà ‡Æ§‡Æü‡Øç‡Æü‡Æö‡Øç‡Æö‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡Æï (‡Æï‡ÆÆ‡Ææ‡Æµ‡Ææ‡Æ≤‡Øç ‡Æ™‡Æø‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç)',
                symptomChecker: '‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø ‡Æö‡Æ∞‡Æø‡Æ™‡Ææ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Øç',
                analyze: '‡Æè‡Æê ‡Æ®‡Øã‡ÆØ‡Æ±‡Æø‡Æ§‡Æ≤‡Øà ‡Æá‡ÆØ‡Æï‡Øç‡Æï‡ØÅ'
            },
            te: {
                appName: '‡∞∞‡±Ç‡∞∞‡∞≤‡±ç‡∞ï‡±á‡∞∞‡±ç ‡∞™‡±ç‡∞∞‡±ã',
                appSubtitle: 'AI-‡∞Ü‡∞ß‡∞æ‡∞∞‡∞ø‡∞§ ‡∞Ü‡∞∞‡±ã‡∞ó‡±ç‡∞Ø ‡∞∏‡∞π‡∞æ‡∞Ø‡∞ï‡±Å‡∞°‡±Å',
                totalUsers: '‡∞Æ‡±ä‡∞§‡±ç‡∞§‡∞Ç ‡∞µ‡∞ø‡∞®‡∞ø‡∞Ø‡±ã‡∞ó‡∞¶‡∞æ‡∞∞‡±Å‡∞≤‡±Å',
                totalDiagnoses: '‡∞∞‡±ã‡∞ó ‡∞®‡∞ø‡∞∞‡±ç‡∞ß‡∞æ‡∞∞‡∞£‡∞≤‡±Å',
                highRisk: '‡∞Ö‡∞ß‡∞ø‡∞ï ‡∞™‡±ç‡∞∞‡∞Æ‡∞æ‡∞¶‡∞Ç',
                today: '‡∞à‡∞∞‡±ã‡∞ú‡±Å',
                patientInfo: '‡∞∞‡±ã‡∞ó‡∞ø ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç',
                fullName: '‡∞™‡±Ç‡∞∞‡±ç‡∞§‡∞ø ‡∞™‡±á‡∞∞‡±Å',
                age: '‡∞µ‡∞Ø‡∞∏‡±ç‡∞∏‡±Å',
                voiceTitle: '‡∞µ‡∞æ‡∞Ø‡∞ø‡∞∏‡±ç ‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞Ç ‡∞∞‡∞ø‡∞ï‡∞æ‡∞∞‡±ç‡∞°‡∞∞‡±ç',
                typeSymptoms: '‡∞≤‡±á‡∞¶‡∞æ ‡∞Æ‡±Ä ‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞æ‡∞≤‡∞®‡±Å ‡∞ü‡±à‡∞™‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø (‡∞ï‡∞æ‡∞Æ‡∞æ‡∞§‡±ã ‡∞µ‡±á‡∞∞‡±Å ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø)',
                symptomChecker: '‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞Ç ‡∞™‡∞∞‡∞ø‡∞∂‡±Ä‡∞≤‡∞ï‡±Å‡∞°‡±Å',
                analyze: 'AI ‡∞µ‡∞ø‡∞∂‡±ç‡∞≤‡±á‡∞∑‡∞£‡∞®‡±Å ‡∞∞‡∞®‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø'
            },
            kn: {
                appName: '‡≤∞‡≥Ç‡≤∞‡≤≤‡≥ç‡≤ï‡≥á‡≤∞‡≥ç ‡≤™‡≥ç‡≤∞‡≥ã',
                appSubtitle: 'AI-‡≤ö‡≤æ‡≤≤‡≤ø‡≤§ ‡≤Ü‡≤∞‡≥ã‡≤ó‡≥ç‡≤Ø ‡≤∏‡≤π‡≤æ‡≤Ø‡≤ï',
                totalUsers: '‡≤í‡≤ü‡≥ç‡≤ü‡≥Å ‡≤¨‡≤≥‡≤ï‡≥Ü‡≤¶‡≤æ‡≤∞‡≤∞‡≥Å',
                totalDiagnoses: '‡≤∞‡≥ã‡≤ó‡≤®‡≤ø‡≤∞‡≥ç‡≤£‡≤Ø‡≤ó‡≤≥‡≥Å',
                highRisk: '‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≤ø‡≤® ‡≤Ö‡≤™‡≤æ‡≤Ø',
                today: '‡≤á‡≤Ç‡≤¶‡≥Å',
                patientInfo: '‡≤∞‡≥ã‡≤ó‡≤ø‡≤Ø ‡≤Æ‡≤æ‡≤π‡≤ø‡≤§‡≤ø',
                fullName: '‡≤™‡≥Ç‡≤∞‡≥ç‡≤£ ‡≤π‡≥Ü‡≤∏‡≤∞‡≥Å',
                age: '‡≤µ‡≤Ø‡≤∏‡≥ç‡≤∏‡≥Å',
                voiceTitle: '‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤∞‡≥ã‡≤ó‡≤≤‡≤ï‡≥ç‡≤∑‡≤£ ‡≤∞‡≥Ü‡≤ï‡≤æ‡≤∞‡≥ç‡≤°‡≤∞‡≥ç',
                typeSymptoms: '‡≤Ö‡≤•‡≤µ‡≤æ ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤∞‡≥ã‡≤ó‡≤≤‡≤ï‡≥ç‡≤∑‡≤£‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤ü‡≥à‡≤™‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø (‡≤Ö‡≤≤‡≥ç‡≤™‡≤µ‡≤ø‡≤∞‡≤æ‡≤Æ‡≤¶‡≤ø‡≤Ç‡≤¶ ‡≤¨‡≥á‡≤∞‡≥ç‡≤™‡≤°‡≤ø‡≤∏‡≤ø)',
                symptomChecker: '‡≤∞‡≥ã‡≤ó‡≤≤‡≤ï‡≥ç‡≤∑‡≤£ ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ï',
                analyze: 'AI ‡≤∞‡≥ã‡≤ó‡≤®‡≤ø‡≤∞‡≥ç‡≤£‡≤Ø‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤∞‡≤®‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø'
            },
            ml: {
                appName: '‡¥±‡µÇ‡¥±‡µΩ‡¥ï‡µÜ‡¥Ø‡µº ‡¥™‡µç‡¥∞‡µã',
                appSubtitle: 'AI-‡¥™‡¥µ‡µº‡¥°‡µç ‡¥π‡µÜ‡µΩ‡¥§‡µç‡¥§‡µç‡¥ï‡µÜ‡¥Ø‡µº ‡¥Ö‡¥∏‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡¥®‡µç‡¥±‡µç',
                totalUsers: '‡¥Ü‡¥ï‡µÜ ‡¥â‡¥™‡¥Ø‡µã‡¥ï‡µç‡¥§‡¥æ‡¥ï‡µç‡¥ï‡µæ',
                totalDiagnoses: '‡¥∞‡µã‡¥ó‡¥®‡¥ø‡µº‡¥£‡¥Ø‡¥ô‡µç‡¥ô‡µæ',
                highRisk: '‡¥â‡¥Ø‡µº‡¥®‡µç‡¥® ‡¥Ö‡¥™‡¥ï‡¥ü‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§',
                today: '‡¥á‡¥®‡µç‡¥®‡µç',
                patientInfo: '‡¥∞‡µã‡¥ó‡¥ø‡¥Ø‡µÅ‡¥ü‡µÜ ‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ',
                fullName: '‡¥™‡µÇ‡µº‡¥£‡µç‡¥£‡¥®‡¥æ‡¥Æ‡¥Ç',
                age: '‡¥™‡µç‡¥∞‡¥æ‡¥Ø‡¥Ç',
                voiceTitle: '‡¥∂‡¥¨‡µç‡¥¶ ‡¥∞‡µã‡¥ó‡¥≤‡¥ï‡µç‡¥∑‡¥£ ‡¥±‡µÜ‡¥ï‡µç‡¥ï‡µã‡µº‡¥°‡µº',
                typeSymptoms: '‡¥Ö‡¥≤‡µç‡¥≤‡µÜ‡¥ô‡µç‡¥ï‡¥ø‡µΩ ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∞‡µã‡¥ó‡¥≤‡¥ï‡µç‡¥∑‡¥£‡¥ô‡µç‡¥ô‡µæ ‡¥ü‡µà‡¥™‡µç‡¥™‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï (‡¥ï‡µã‡¥Æ‡¥Ø‡¥æ‡µΩ ‡¥µ‡µá‡µº‡¥§‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï)',
                symptomChecker: '‡¥∞‡µã‡¥ó‡¥≤‡¥ï‡µç‡¥∑‡¥£ ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ï‡µª',
                analyze: 'AI ‡¥°‡¥Ø‡¥ó‡µç‡¥®‡µã‡¥∏‡¥ø‡¥∏‡µç ‡¥™‡µç‡¥∞‡¥µ‡µº‡¥§‡µç‡¥§‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï'
            }
        };

        // ==================== DISTRICTS ====================
        const districts = [
            'Chennai', 'Coimbatore', 'Madurai', 'Tiruchirappalli', 'Salem',
            'Tirunelveli', 'Vellore', 'Erode', 'Kanyakumari', 'Dharmapuri'
        ];

        // ==================== SYMPTOMS DATABASE ====================
        const symptomsDB = [
            { id: 1, name: 'Cough', category: 'respiratory' },
            { id: 2, name: 'Shortness of breath', category: 'respiratory' },
            { id: 3, name: 'Wheezing', category: 'respiratory' },
            { id: 4, name: 'Chest pain', category: 'respiratory' },
            { id: 5, name: 'Sore throat', category: 'respiratory' },
            { id: 6, name: 'Runny nose', category: 'respiratory' },
            { id: 7, name: 'Nausea', category: 'digestive' },
            { id: 8, name: 'Vomiting', category: 'digestive' },
            { id: 9, name: 'Diarrhea', category: 'digestive' },
            { id: 10, name: 'Abdominal pain', category: 'digestive' },
            { id: 11, name: 'Headache', category: 'neurological' },
            { id: 12, name: 'Dizziness', category: 'neurological' },
            { id: 13, name: 'Confusion', category: 'neurological' },
            { id: 14, name: 'Fever', category: 'general' },
            { id: 15, name: 'Fatigue', category: 'general' },
            { id: 16, name: 'Chills', category: 'general' }
        ];

        // ==================== DISEASE DATABASE ====================
        const diseasesDB = [
            {
                id: 1,
                name: 'Common Cold',
                symptoms: [1, 5, 6, 14],
                severity: 'low',
                description: 'Viral infection of upper respiratory tract',
                recommendations: ['Rest', 'Hydrate', 'OTC medications'],
                homeRemedies: ['Ginger tea', 'Honey', 'Steam inhalation'],
                medicines: ['Paracetamol 650mg', 'Cetirizine 10mg'],
                warningSigns: ['High fever', 'Difficulty breathing']
            },
            {
                id: 2,
                name: 'Influenza',
                symptoms: [1, 14, 15, 16],
                severity: 'medium',
                description: 'Viral infection affecting respiratory system',
                recommendations: ['Rest', 'Isolate', 'Antiviral medications'],
                homeRemedies: ['Warm fluids', 'Honey lemon tea'],
                medicines: ['Oseltamivir 75mg', 'Paracetamol 650mg'],
                warningSigns: ['Breathing difficulty', 'Chest pain']
            },
            {
                id: 3,
                name: 'Gastroenteritis',
                symptoms: [7, 8, 9, 10],
                severity: 'medium',
                description: 'Stomach and intestinal inflammation',
                recommendations: ['ORS', 'Bland diet', 'Rest'],
                homeRemedies: ['Coconut water', 'Ginger tea'],
                medicines: ['ORS packets', 'Zinc 20mg'],
                warningSigns: ['Severe dehydration', 'Blood in stool']
            },
            {
                id: 4,
                name: 'Migraine',
                symptoms: [11, 12, 15],
                severity: 'medium',
                description: 'Severe headache disorder',
                recommendations: ['Dark room', 'Avoid triggers', 'Rest'],
                homeRemedies: ['Cold compress', 'Peppermint oil'],
                medicines: ['Sumatriptan', 'Ibuprofen 400mg'],
                warningSigns: ['Sudden severe headache', 'Neurological symptoms']
            }
        ];

        let selectedSymptoms = [];
        let currentCategory = 'all';
        let mediaRecorder = null;
        let audioChunks = [];
        let isRecording = false;
        let recordingSeconds = 0;
        let recordingTimer = null;
        let mediaStream = null;

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            if (currentUser) {
                showMainApp();
            }
            loadDistricts();
            displaySymptoms('all');
            updateStats();
        });

        // ==================== AUTHENTICATION ====================
        function switchAuthTab(tab) {
            document.querySelectorAll('.login-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.login-form').forEach(f => f.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + 'Form').classList.add('active');
        }

        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                showMainApp();
                showToast('Login successful!', 'success');
            } else {
                showToast('Invalid email or password', 'error');
            }
        }

        function handleSignup() {
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const phone = document.getElementById('signupPhone').value;
            
            if (!name || !email || !password) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            if (users.find(u => u.email === email)) {
                showToast('Email already exists', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                name,
                email,
                password,
                phone,
                createdAt: new Date().toISOString()
            };
            
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            
            showMainApp();
            showToast('Account created successfully!', 'success');
        }

        function handleForgotPassword() {
            const email = document.getElementById('forgotEmail').value;
            
            if (!email) {
                showToast('Please enter your email', 'error');
                return;
            }
            
            const user = users.find(u => u.email === email);
            
            if (user) {
                const resetToken = Math.random().toString(36).substring(2, 15);
                showToast(`Password reset link sent to ${email}`, 'success');
                console.log('Reset link:', `http://localhost:3000/reset-password?token=${resetToken}`);
                
                // Demo password reset
                setTimeout(() => {
                    const newPassword = prompt('Enter new password (demo):');
                    if (newPassword) {
                        user.password = newPassword;
                        localStorage.setItem('users', JSON.stringify(users));
                        showToast('Password updated successfully!', 'success');
                    }
                }, 2000);
            } else {
                showToast('Email not found', 'error');
            }
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('mainApp').classList.remove('visible');
            document.getElementById('loginPage').style.display = 'flex';
            showToast('Logged out successfully', 'success');
        }

        function showMainApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainApp').classList.add('visible');
            document.getElementById('totalUsers').textContent = users.length;
            updateStats();
        }

        // ==================== LANGUAGE ====================
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const t = translations[lang] || translations.en;
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) el.textContent = t[key];
            });
            
            document.getElementById('voiceStatus').innerHTML = `<i class="fas fa-info-circle"></i> Click the microphone and speak in ${lang === 'en' ? 'English' : lang === 'hi' ? 'Hindi' : lang === 'ta' ? 'Tamil' : lang === 'te' ? 'Telugu' : lang === 'kn' ? 'Kannada' : 'Malayalam'}`;
        }

        // ==================== DISTRICTS ====================
        function loadDistricts() {
            const select = document.getElementById('patientDistrict');
            districts.forEach(d => {
                const option = document.createElement('option');
                option.value = d;
                option.textContent = d;
                select.appendChild(option);
            });
        }

        // ==================== SYMPTOMS ====================
        function displaySymptoms(category) {
            const grid = document.getElementById('symptomsGrid');
            grid.innerHTML = '';
            
            const filtered = category === 'all' ? symptomsDB : symptomsDB.filter(s => s.category === category);
            
            filtered.forEach(symptom => {
                const item = document.createElement('div');
                item.className = `symptom-item ${selectedSymptoms.includes(symptom.id) ? 'selected' : ''}`;
                item.onclick = () => toggleSymptom(symptom.id);
                
                item.innerHTML = `
                    <input type="checkbox" ${selectedSymptoms.includes(symptom.id) ? 'checked' : ''}>
                    <span>${symptom.name}</span>
                `;
                
                grid.appendChild(item);
            });
        }

        function filterSymptoms(category) {
            currentCategory = category;
            document.querySelectorAll('.category-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            displaySymptoms(category);
        }

        function toggleSymptom(id) {
            const index = selectedSymptoms.indexOf(id);
            if (index === -1) {
                selectedSymptoms.push(id);
            } else {
                selectedSymptoms.splice(index, 1);
            }
            updateSymptomTags();
            displaySymptoms(currentCategory);
        }

        function updateSymptomTags() {
            const container = document.getElementById('symptomTags');
            container.innerHTML = '';
            
            selectedSymptoms.forEach(id => {
                const symptom = symptomsDB.find(s => s.id === id);
                if (symptom) {
                    const tag = document.createElement('span');
                    tag.className = 'symptom-tag';
                    tag.innerHTML = `${symptom.name} <button onclick="removeSymptom(${id})">√ó</button>`;
                    container.appendChild(tag);
                }
            });
        }

        function removeSymptom(id) {
            const index = selectedSymptoms.indexOf(id);
            if (index !== -1) {
                selectedSymptoms.splice(index, 1);
                updateSymptomTags();
                displaySymptoms(currentCategory);
            }
        }

        // ==================== VOICE RECORDING - FIXED MULTILINGUAL ====================
        async function toggleRecording() {
            if (!isRecording) {
                try {
                    mediaStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(mediaStream);
                    audioChunks = [];
                    
                    mediaRecorder.ondataavailable = (e) => {
                        audioChunks.push(e.data);
                    };
                    
                    mediaRecorder.onstop = () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                        
                        // Simulate speech recognition based on current language
                        const recognizedTexts = {
                            en: 'cough, fever, headache',
                            hi: '‡§ñ‡§æ‡§Ç‡§∏‡•Ä, ‡§¨‡•Å‡§ñ‡§æ‡§∞, ‡§∏‡§ø‡§∞‡§¶‡§∞‡•ç‡§¶',
                            ta: '‡Æá‡Æ∞‡ØÅ‡ÆÆ‡Æ≤‡Øç, ‡Æï‡Ææ‡ÆØ‡Øç‡Æö‡Øç‡Æö‡Æ≤‡Øç, ‡Æ§‡Æ≤‡Øà‡Æµ‡Æ≤‡Æø',
                            te: '‡∞¶‡∞ó‡±ç‡∞ó‡±Å, ‡∞ú‡±ç‡∞µ‡∞∞‡∞Ç, ‡∞§‡∞≤‡∞®‡±ä‡∞™‡±ç‡∞™‡∞ø',
                            kn: '‡≤ï‡≥Ü‡≤Æ‡≥ç‡≤Æ‡≥Å, ‡≤ú‡≥ç‡≤µ‡≤∞, ‡≤§‡≤≤‡≥Ü‡≤®‡≥ã‡≤µ‡≥Å',
                            ml: '‡¥ö‡µÅ‡¥Æ, ‡¥™‡¥®‡¥ø, ‡¥§‡¥≤‡¥µ‡µá‡¥¶‡¥®'
                        };
                        
                        const recognizedText = recognizedTexts[currentLanguage] || recognizedTexts.en;
                        
                        // Display recognized text
                        document.getElementById('recognizedText').textContent = recognizedText;
                        
                        // Auto-fill symptoms textarea
                        document.getElementById('symptomsText').value = recognizedText;
                        
                        // Auto-select matching symptoms
                        const words = recognizedText.toLowerCase().split(/[,\s]+/);
                        words.forEach(word => {
                            const match = symptomsDB.find(s => 
                                s.name.toLowerCase().includes(word) || 
                                (currentLanguage !== 'en' && word.includes(s.name.toLowerCase()))
                            );
                            if (match && !selectedSymptoms.includes(match.id)) {
                                selectedSymptoms.push(match.id);
                            }
                        });
                        
                        updateSymptomTags();
                        displaySymptoms(currentCategory);
                        
                        mediaStream.getTracks().forEach(track => track.stop());
                        showToast('Voice captured successfully!', 'success');
                    };
                    
                    mediaRecorder.start();
                    isRecording = true;
                    
                    document.getElementById('recordBtn').classList.add('recording');
                    document.getElementById('recordBtn').innerHTML = '<i class="fas fa-stop"></i>';
                    document.getElementById('voiceStatus').innerHTML = '<i class="fas fa-spinner fa-pulse"></i> Recording... Speak now';
                    
                    recordingSeconds = 0;
                    recordingTimer = setInterval(() => {
                        recordingSeconds++;
                        const mins = Math.floor(recordingSeconds / 60);
                        const secs = recordingSeconds % 60;
                        document.getElementById('timer').textContent = 
                            `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                    }, 1000);
                    
                } catch (err) {
                    showToast('Please allow microphone access', 'error');
                    console.error(err);
                }
            } else {
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                }
                clearInterval(recordingTimer);
                isRecording = false;
                document.getElementById('recordBtn').classList.remove('recording');
                document.getElementById('recordBtn').innerHTML = '<i class="fas fa-microphone"></i>';
                document.getElementById('voiceStatus').innerHTML = '<i class="fas fa-check-circle"></i> Recording completed';
            }
        }

        // ==================== AI DIAGNOSIS ====================
        function analyzeHealth() {
            const name = document.getElementById('patientName').value;
            const age = document.getElementById('patientAge').value;
            const district = document.getElementById('patientDistrict').value;
            
            if (!name || !age || !district) {
                showToast('Please fill patient details', 'error');
                return;
            }
            
            // Get typed symptoms
            const typedText = document.getElementById('symptomsText').value.toLowerCase();
            const typedSymptoms = typedText.split(',').map(s => s.trim()).filter(s => s);
            
            // Combine all symptoms
            let allSymptoms = [...selectedSymptoms];
            
            typedSymptoms.forEach(text => {
                const match = symptomsDB.find(s => 
                    s.name.toLowerCase().includes(text) || 
                    text.includes(s.name.toLowerCase())
                );
                if (match && !allSymptoms.includes(match.id)) {
                    allSymptoms.push(match.id);
                }
            });
            
            if (allSymptoms.length === 0) {
                showToast('Please select or type symptoms', 'error');
                return;
            }
            
            // Find best matching disease
            let bestMatch = null;
            let bestScore = 0;
            
            diseasesDB.forEach(disease => {
                const matches = disease.symptoms.filter(s => allSymptoms.includes(s)).length;
                const score = (matches / disease.symptoms.length) * 100;
                
                if (score > bestScore) {
                    bestScore = score;
                    bestMatch = disease;
                }
            });
            
            if (!bestMatch) {
                bestMatch = diseasesDB[0];
                bestScore = 30;
            }
            
            // Display results
            displayResults(bestMatch, bestScore, allSymptoms);
            
            // Save diagnosis
            const diagnosis = {
                id: Date.now(),
                patientName: name,
                district: district,
                diagnosis: bestMatch.name,
                severity: bestMatch.severity,
                date: new Date().toISOString(),
                userId: currentUser?.id
            };
            
            diagnoses.push(diagnosis);
            localStorage.setItem('diagnoses', JSON.stringify(diagnoses));
            updateStats();
            
            showToast('Analysis complete!', 'success');
        }

        function displayResults(disease, score, symptoms) {
            const resultsDiv = document.getElementById('results');
            const severityClass = `severity-${disease.severity}`;
            
            const matchedSymptoms = disease.symptoms
                .filter(id => symptoms.includes(id))
                .map(id => symptomsDB.find(s => s.id === id)?.name)
                .filter(name => name);
            
            let html = `
                <h2 style="color: var(--primary); margin-bottom: 20px;">AI Diagnosis Report</h2>
                
                <div style="margin-bottom: 20px;">
                    <h3>${disease.name}</h3>
                    <span class="severity-badge ${severityClass}">${disease.severity.toUpperCase()}</span>
                    <p style="margin-top: 10px;">${disease.description}</p>
                    <p><strong>Match Confidence:</strong> ${Math.round(score)}%</p>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>‚úÖ Matching Symptoms:</h4>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        ${matchedSymptoms.map(s => `<span style="background: var(--success); color: white; padding: 5px 15px; border-radius: 20px;">${s}</span>`).join('')}
                    </div>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>üìã Recommendations:</h4>
                    <ul>${disease.recommendations.map(r => `<li>${r}</li>`).join('')}</ul>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>üè† Home Remedies:</h4>
                    <ul>${disease.homeRemedies.map(r => `<li>${r}</li>`).join('')}</ul>
                </div>
                
                <div style="margin: 20px 0;">
                    <h4>üíä Medicines:</h4>
                    <ul>${disease.medicines.map(m => `<li>${m}</li>`).join('')}</ul>
                </div>
            `;
            
            if (disease.severity === 'high') {
                html += `
                    <div style="background: #fee2e2; padding: 20px; border-radius: 20px; margin: 20px 0;">
                        <h4 style="color: var(--danger);">‚ö†Ô∏è CONSULT DOCTOR IMMEDIATELY</h4>
                        <ul>${disease.warningSigns.map(s => `<li>${s}</li>`).join('')}</ul>
                    </div>
                `;
            }
            
            html += `
                <div style="margin-top: 20px;">
                    <button class="login-btn" onclick="window.print()" style="width: auto; padding: 12px 30px;">
                        <i class="fas fa-print"></i> Print Report
                    </button>
                </div>
            `;
            
            resultsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // ==================== STATS ====================
        function updateStats() {
            document.getElementById('totalUsers').textContent = users.length;
            document.getElementById('totalDiagnoses').textContent = diagnoses.length;
            document.getElementById('highRiskCount').textContent = diagnoses.filter(d => d.severity === 'high').length;
            document.getElementById('todayCount').textContent = diagnoses.filter(d => 
                new Date(d.date).toDateString() === new Date().toDateString()
            ).length;
        }

        // ==================== DOCTOR PORTAL ====================
        function toggleDoctorPanel() {
            const panel = document.getElementById('doctorPanel');
            panel.classList.toggle('visible');
        }

        function doctorLogin() {
            const username = document.getElementById('doctorUsername').value;
            const password = document.getElementById('doctorPassword').value;
            
            if (username === 'doctor' && password === '123') {
                doctorLoggedIn = true;
                document.getElementById('doctorDashboard').style.display = 'block';
                document.getElementById('doctorToggleBtn').innerHTML = '<i class="fas fa-lock-open"></i> Doctor Dashboard';
                
                // Display patient list
                const list = document.getElementById('doctorPatientList');
                list.innerHTML = diagnoses.map(d => `
                    <div class="doctor-card">
                        <h4>${d.patientName}</h4>
                        <p><strong>Diagnosis:</strong> ${d.diagnosis}</p>
                        <p><strong>Severity:</strong> <span class="severity-${d.severity}">${d.severity}</span></p>
                        <p><strong>Date:</strong> ${new Date(d.date).toLocaleString()}</p>
                        <p><strong>District:</strong> ${d.district}</p>
                    </div>
                `).join('') || '<p>No diagnoses yet</p>';
                
                showToast('Doctor login successful', 'success');
            } else {
                showToast('Invalid credentials', 'error');
            }
        }

        function doctorLogout() {
            doctorLoggedIn = false;
            document.getElementById('doctorDashboard').style.display = 'none';
            document.getElementById('doctorToggleBtn').innerHTML = '<i class="fas fa-lock"></i> Login as Doctor';
            document.getElementById('doctorPanel').classList.remove('visible');
            showToast('Logged out', 'success');
        }

        function saveDoctorNote() {
            const note = document.getElementById('doctorNote').value;
            if (note) {
                showToast('Note saved successfully', 'success');
                document.getElementById('doctorNote').value = '';
            }
        }

        // ==================== TOAST ====================
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast show ${type}`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>
